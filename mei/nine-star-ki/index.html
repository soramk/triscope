<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹æ˜Ÿæ°—å­¦ï¼šé‹å‹¢ã¨æ–¹ä½ã®ç§‘å­¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <!-- å…±é€šCSS -->
    <link rel="stylesheet" href="../../assets/common.css">

    <!-- Chosen Palette: Traditional Japanese Modern -->
    <!-- Background: Go fun (Oyster White) #f7f3e8 -->
    <!-- Primary: Ai (Indigo) #1e3a5f for wisdom/trust -->
    <!-- Accent: Yamabuki (Golden Yellow) #d4af37 for earth/center -->
    <!-- Text: Sumi (Ink) #2c2c2c -->

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'jp-bg': '#f7f3e8',
                        'jp-indigo': '#1e3a5f',
                        'jp-gold': '#d4af37',
                        'jp-text': '#2c2c2c',
                        'jp-accent': '#c24a4a', // Traditional Red
                        'jp-gray': '#787c7e'
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                        serif: ['"Noto Serif JP"', 'serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* bodyã‚¹ã‚¿ã‚¤ãƒ«ã¯ common.css ã§å®šç¾© */

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            height: 350px;
            max-height: 400px;
        }

        .magic-square-cell {
            transition: all 0.3s ease;
        }

        .magic-square-cell:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            z-index: 10;
        }

        .tab-active {
            border-bottom: 2px solid #1e3a5f;
            color: #1e3a5f;
            font-weight: bold;
        }

        .tab-inactive {
            color: #787c7e;
        }

        .timeline-line {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #d1d5db;
            z-index: 0;
        }

        @media (max-width: 768px) {
            .timeline-line {
                left: 20px;
            }
        }
    </style>

    <!-- Application Structure Plan: 
         1. Hero Section: Title and simple definition.
         2. Tab Navigation: Overview, What It Tells (Analysis), Logic & History, Practical Tool (Calculator).
         3. Content Sections:
            - Overview: Cards defining characteristics (Mei/So/Boku).
            - Analysis: Chart.js comparing strengths vs weaknesses.
            - Logic: Interactive Magic Square (Lo Shu) to explain the 9 stars.
            - History: Vertical timeline.
            - Calculator: User inputs birth year, gets their star and explanation (Simulates "How to do it").
         Rationale: This structure allows the user to first understand the "What" and "Why", then deep dive into "How it works", and finally experience it personally.
    -->

    <!-- Visualization & Content Choices:
         - Suitability Radar/Bar Chart: To visually answer "What is it good for?" compared to other fortune telling.
         - Interactive 3x3 Grid: Essential for explaining the "Lo Shu Square" logic without using static images or SVG.
         - Calculator Form: Replaces static text about "how to calculate" with an actual functional tool.
         - Timeline: CSS/HTML layout for history.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>

<body class="font-sans antialiased flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-jp-indigo text-white shadow-md">
        <div class="container mx-auto px-4 py-6 text-center">
            <h1 class="text-3xl md:text-4xl font-serif font-bold tracking-wider mb-2">ä¹æ˜Ÿæ°—å­¦ãƒ¬ãƒãƒ¼ãƒˆ</h1>
            <p class="text-jp-bg opacity-90 text-sm md:text-base">è‡ªç„¶ã®ã€Œæ°—ã€ã¨ã€Œæ–¹ä½ã€ãŒç¹”ã‚Šãªã™é‹å‘½å­¦ã®æ¢æ±‚</p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex overflow-x-auto justify-center space-x-8 py-4 whitespace-nowrap" id="main-nav">
                <button onclick="switchTab('overview')" id="nav-overview"
                    class="tab-active px-2 pb-1 transition-colors">æ¦‚è¦ã¨ç‰¹æ€§</button>
                <button onclick="switchTab('analysis')" id="nav-analysis"
                    class="tab-inactive px-2 pb-1 transition-colors hover:text-jp-indigo">å¾—æ„åˆ†é‡</button>
                <button onclick="switchTab('logic')" id="nav-logic"
                    class="tab-inactive px-2 pb-1 transition-colors hover:text-jp-indigo">æ ¹æ‹ ã¨æ­´å²</button>
                <button onclick="switchTab('practice')" id="nav-practice"
                    class="tab-inactive px-2 pb-1 transition-colors hover:text-jp-indigo font-bold text-jp-accent">ã€å®Ÿè·µã€‘æœ¬å‘½æ˜Ÿé‘‘å®š</button>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto px-4 py-8 max-w-5xl">

        <!-- SECTION 1: OVERVIEW -->
        <div id="view-overview" class="block animate-fade-in">
            <div class="mb-8">
                <h2 class="text-2xl font-serif font-bold text-jp-indigo border-l-4 border-jp-gold pl-4 mb-4">ä¹æ˜Ÿæ°—å­¦ã¨ã¯</h2>
                <p class="leading-relaxed text-jp-text mb-4">
                    ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ä¹æ˜Ÿæ°—å­¦ã®åŸºæœ¬çš„ãªå®šç¾©ã¨ãã®ä½ç½®ã¥ã‘ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
                    ä¹æ˜Ÿæ°—å­¦ã¯å˜ãªã‚‹å ã„ã§ã¯ãªãã€**ã€Œå‹•ãã“ã¨ã§é‹å‘½ã‚’å¤‰ãˆã‚‹ã€**ã¨ã„ã†èƒ½å‹•çš„ãªå´é¢ã‚’æŒã¤ã€æ—¥æœ¬ç‹¬è‡ªã®ç™ºå±•ã‚’é‚ã’ãŸé–‹é‹å­¦ã§ã™ã€‚
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                <!-- Card 1 -->
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-jp-indigo">
                    <div class="text-4xl mb-3 text-center">ğŸŒ</div>
                    <h3 class="text-xl font-bold text-center mb-2">ç›¸è¡“ãƒ»å‘½è¡“ã®èåˆ</h3>
                    <p class="text-sm text-gray-600">
                        ç”Ÿã¾ã‚ŒãŸæ™‚é–“ã«åŸºã¥ãã€Œå‘½è¡“ï¼ˆã‚ã„ã˜ã‚…ã¤ï¼‰ã€ã¨ã€
                        ç’°å¢ƒã‚„æ–¹ä½ã«åŸºã¥ãã€Œç›¸è¡“ï¼ˆãã†ã˜ã‚…ã¤ï¼‰ã€ã®ä¸¡æ–¹ã®å´é¢ã‚’æŒã¡ã¾ã™ã€‚
                        å®¿å‘½ã‚’çŸ¥ã‚Šã€ç’°å¢ƒã‚’åˆ©ç”¨ã—ã¦é‹ã‚’é–‹ãã¾ã™ã€‚
                    </p>
                </div>
                <!-- Card 2 -->
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-jp-gold">
                    <div class="text-4xl mb-3 text-center">ğŸ§­</div>
                    <h3 class="text-xl font-bold text-center mb-2">æ–¹ä½å­¦ã®æ±ºå®šç‰ˆ</h3>
                    <p class="text-sm text-gray-600">
                        æœ€å¤§ã®ç‰¹å¾´ã¯ã€Œæ–¹ä½ã€ã¸ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã™ã€‚
                        å¼•è¶Šã—ã‚„æ—…è¡Œãªã©ã€ç‰©ç†çš„ãªç§»å‹•ã«ã‚ˆã£ã¦ã€Œæ°—ã€ã‚’å–ã‚Šè¾¼ã¿ã€
                        å¾Œå¤©çš„ã«é‹å‹¢ã‚’å¥½è»¢ã•ã›ã‚‹æŠ€è¡“ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ã€‚
                    </p>
                </div>
                <!-- Card 3 -->
                <div class="bg-white p-6 rounded-lg shadow-md border-t-4 border-jp-accent">
                    <div class="text-4xl mb-3 text-center">ğŸ“Š</div>
                    <h3 class="text-xl font-bold text-center mb-2">å¾ªç’°ã™ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>
                    <p class="text-sm text-gray-600">
                        ã€Œæ°—ã€ã¯9ã¤ã®æ€§è³ªï¼ˆä¹æ˜Ÿï¼‰ã«åˆ†é¡ã•ã‚Œã€ä¸€å®šã®æ³•å‰‡ã§å¾ªç’°ã—ã¦ã„ã¾ã™ã€‚
                        ä»Šã®è‡ªåˆ†ãŒã©ã®ã‚µã‚¤ã‚¯ãƒ«ã«ã„ã‚‹ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã§ã€æœ€é©ãªè¡Œå‹•æŒ‡é‡ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚
                    </p>
                </div>
            </div>

            <div class="bg-white rounded-xl p-6 shadow-inner bg-opacity-50 border border-stone-200">
                <h3 class="text-lg font-bold text-jp-indigo mb-3">ä»–ã®å ã„ã¨ã®æ¯”è¼ƒ</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-700">
                        <thead class="text-xs text-gray-700 uppercase bg-stone-100">
                            <tr>
                                <th class="px-4 py-3 rounded-tl-lg">å è¡“å</th>
                                <th class="px-4 py-3">åˆ†é¡</th>
                                <th class="px-4 py-3">ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</th>
                                <th class="px-4 py-3 rounded-tr-lg">ä¹æ˜Ÿæ°—å­¦ã¨ã®é•ã„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-white border-b">
                                <td class="px-4 py-3 font-bold">ä¹æ˜Ÿæ°—å­¦</td>
                                <td class="px-4 py-3">å‘½è¡“ ï¼‹ ç›¸è¡“</td>
                                <td class="px-4 py-3">æ°—ãƒ»æ–¹ä½ãƒ»å¾ªç’°</td>
                                <td class="px-4 py-3">è¡Œå‹•ï¼ˆç§»å‹•ï¼‰ã«ã‚ˆã‚Šé‹ã‚’å¤‰ãˆã‚‰ã‚Œã‚‹ã¨ã™ã‚‹ç‚¹ãŒå¼·ã„ã€‚</td>
                            </tr>
                            <tr class="bg-stone-50 border-b">
                                <td class="px-4 py-3 font-bold">è¥¿æ´‹å æ˜Ÿè¡“</td>
                                <td class="px-4 py-3">å‘½è¡“</td>
                                <td class="px-4 py-3">å¤©ä½“é…ç½®</td>
                                <td class="px-4 py-3">å€‹äººã®è³‡è³ªåˆ†æã«é•·ã‘ã‚‹ãŒã€ã€Œæ–¹ä½ã€ã®æ¦‚å¿µã¯å¸Œè–„ã€‚</td>
                            </tr>
                            <tr class="bg-white border-b">
                                <td class="px-4 py-3 font-bold">ã‚¿ãƒ­ãƒƒãƒˆ</td>
                                <td class="px-4 py-3">åœè¡“ï¼ˆã¼ãã˜ã‚…ã¤ï¼‰</td>
                                <td class="px-4 py-3">å¶ç„¶æ€§ãƒ»ç›´æ„Ÿ</td>
                                <td class="px-4 py-3">ã€Œä»Šã€ã®æ„Ÿæƒ…ã‚„çŸ­æœŸçš„ãªå‰å‡¶ã«å¼·ã„ã€‚é•·æœŸçš„ã‚µã‚¤ã‚¯ãƒ«ã¯è‹¦æ‰‹ã€‚</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SECTION 2: ANALYSIS (WHAT IT TELLS) -->
        <div id="view-analysis" class="hidden animate-fade-in">
            <div class="mb-8">
                <h2 class="text-2xl font-serif font-bold text-jp-indigo border-l-4 border-jp-gold pl-4 mb-4">ã‚ã‹ã‚‹ã“ã¨ãƒ»å¾—æ„åˆ†é‡
                </h2>
                <p class="leading-relaxed text-jp-text mb-4">
                    ä¹æ˜Ÿæ°—å­¦ã«ã¯æ˜ç¢ºãªã€Œå¾—æ„ã€ã¨ã€Œä¸å¾—æ„ã€ãŒã‚ã‚Šã¾ã™ã€‚
                    ã“ã“ã§ã¯ã€ä¹æ˜Ÿæ°—å­¦ãŒã©ã®ã‚ˆã†ãªç›¸è«‡å†…å®¹ã«é©ã—ã¦ã„ã‚‹ã‹ã‚’å¯è¦–åŒ–ã—ã¾ã—ãŸã€‚
                    ç‰¹ã«**ã€Œé–‹é‹ã®ãŸã‚ã®è¡Œå‹•ã€**ã‚’ç¤ºå”†ã™ã‚‹ç‚¹ã«ãŠã„ã¦ã€ä»–ã®è¿½éšã‚’è¨±ã—ã¾ã›ã‚“ã€‚
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center mb-10">
                <!-- Text Content -->
                <div class="space-y-6">
                    <div class="bg-white p-5 rounded-lg border-l-4 border-green-500 shadow-sm">
                        <h3 class="font-bold text-lg mb-2 flex items-center">
                            <span class="text-green-500 mr-2">â—</span> å¾—æ„ãªã“ã¨ï¼ˆã‚ã‹ã‚‹ã“ã¨ï¼‰
                        </h3>
                        <ul class="list-disc list-inside text-sm space-y-2 text-gray-700">
                            <li><strong>å‰æ–¹ä½ãƒ»å‡¶æ–¹ä½ï¼š</strong> å¼•ã£è¶Šã—ã€æ—…è¡Œã€ç—…é™¢é¸ã³ã«æœ€é©ãªæ–¹è§’ã€‚</li>
                            <li><strong>é‹å‹¢ã®ãƒã‚¤ã‚ªãƒªã‚ºãƒ ï¼š</strong> ã‚¹ã‚¿ãƒ¼ãƒˆã«é©ã—ãŸæ™‚æœŸã€é™è¦³ã™ã¹ãæ™‚æœŸã€‚</li>
                            <li><strong>æœ¬è³ªçš„ãªæ€§æ ¼ï¼š</strong> ç”Ÿã¾ã‚ŒãŸæ™‚ã®ã€Œæ°—ã€ã®å½±éŸ¿ã«ã‚ˆã‚‹æ°—è³ªã€‚</li>
                            <li><strong>ç›¸æ€§ã¨é–¢ä¿‚æ€§ï¼š</strong> ãŠäº’ã„ã®ã€Œæ°—ã€ãŒåŠ©ã‘åˆã†ã‹ã€åç™ºã™ã‚‹ã‹ã€‚</li>
                            <li><strong>é–‹é‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong> ç¥æ°—å–ã‚Šï¼ˆãŠæ°´å–ã‚Šï¼‰ãªã©å…·ä½“çš„ãªè¡Œå‹•ã€‚</li>
                        </ul>
                    </div>

                    <div class="bg-white p-5 rounded-lg border-l-4 border-gray-400 shadow-sm">
                        <h3 class="font-bold text-lg mb-2 flex items-center">
                            <span class="text-gray-400 mr-2">â—</span> è‹¦æ‰‹ãªã“ã¨ï¼ˆã‚ã‹ã‚‰ãªã„ã“ã¨ï¼‰
                        </h3>
                        <ul class="list-disc list-inside text-sm space-y-2 text-gray-700">
                            <li><strong>ç›¸æ‰‹ã®ã€Œä»Šã€ã®æ°—æŒã¡ï¼š</strong> å¿ƒç†æå†™ã¯ã‚¿ãƒ­ãƒƒãƒˆç­‰ã®åœè¡“ãŒæœ‰åˆ©ã€‚</li>
                            <li><strong>å¶ç„¶ã®å‡ºæ¥äº‹ã®çµæœï¼š</strong> ã€Œæ˜æ—¥ã®è©¦é¨“çµæœã€ãªã©ã®å¶ç„¶æ€§ã®å¼·ã„ã‚‚ã®ã€‚</li>
                            <li><strong>è©³ç´°ãªæœªæ¥äºˆçŸ¥ï¼š</strong> ã€Œä½•æ™‚ä½•åˆ†ã«ä½•ãŒèµ·ãã‚‹ã€ã¨ã„ã£ãŸäºˆè¨€çš„ãªã“ã¨ã€‚</li>
                        </ul>
                    </div>
                </div>

                <!-- Chart Content -->
                <div class="bg-white p-4 rounded-xl shadow-lg">
                    <h3 class="text-center font-bold text-jp-indigo mb-2">é©æ€§åˆ†é‡ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</h3>
                    <div class="chart-container">
                        <canvas id="suitabilityChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-gray-500 mt-2">â€» 10æ®µéšè©•ä¾¡ï¼ˆä¸€èˆ¬çš„è§£é‡ˆã«ã‚ˆã‚‹ï¼‰</p>
                </div>
            </div>

            <div class="bg-indigo-50 p-6 rounded-lg text-center">
                <p class="font-bold text-jp-indigo text-lg">çµè«–ï¼š</p>
                <p class="text-gray-700 mt-2">
                    ã€Œç›¸æ‰‹ã®æ°—æŒã¡ã‚’çŸ¥ã‚ŠãŸã„ã€ãªã‚‰ã‚¿ãƒ­ãƒƒãƒˆã¸ã€‚<br>
                    <strong>ã€Œä»Šã®çŠ¶æ³ã‚’å¤‰ãˆã‚‹ãŸã‚ã«ã€ã„ã¤ãƒ»ã©ã“ã¸å‹•ã‘ã°è‰¯ã„ã‹ã€</strong>ã‚’çŸ¥ã‚ŠãŸã„ãªã‚‰ä¹æ˜Ÿæ°—å­¦ãŒæœ€é©ã§ã™ã€‚
                </p>
            </div>
        </div>

        <!-- SECTION 3: LOGIC & HISTORY -->
        <div id="view-logic" class="hidden animate-fade-in">
            <!-- Logic Part -->
            <div class="mb-12">
                <h2 class="text-2xl font-serif font-bold text-jp-indigo border-l-4 border-jp-gold pl-4 mb-4">
                    æ ¹æ‹ ã¨ãƒ­ã‚¸ãƒƒã‚¯ï¼šé­”æ³•é™£ã®ç§˜å¯†</h2>
                <p class="leading-relaxed text-jp-text mb-6">
                    ä¹æ˜Ÿæ°—å­¦ã®æ ¹åº•ã«ã¯ã€ç´„4000å¹´å‰ã®ä¸­å›½ã§ç™ºè¦‹ã•ã‚ŒãŸã€Œæ´›æ›¸ï¼ˆã‚‰ãã—ã‚‡ï¼‰ã€ã¨ã„ã†å›³å½¢ï¼ˆé­”æ³•é™£ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚
                    ã“ã‚Œã¯ç¸¦ãƒ»æ¨ªãƒ»æ–œã‚ã€ã©ã®åˆ—ã‚’è¶³ã—ã¦ã‚‚ã€Œ15ã€ã«ãªã‚‹ä¸æ€è­°ãªæ•°å­—ã®é…ç½®ã§ã™ã€‚
                    ã“ã®9ã¤ã®æ•°å­—ã«ã€Œäº”è¡Œï¼ˆæœ¨ãƒ»ç«ãƒ»åœŸãƒ»é‡‘ãƒ»æ°´ï¼‰ã€ã‚„è‡ªç„¶è±¡æ„ã‚’å‰²ã‚Šå½“ã¦ãŸã‚‚ã®ãŒ**ä¹æ˜Ÿ**ã§ã™ã€‚
                </p>

                <!-- Interactive Lo Shu Square -->
                <div
                    class="flex flex-col md:flex-row items-center justify-center gap-8 bg-white p-8 rounded-xl shadow-inner">
                    <div
                        class="relative w-64 h-64 grid grid-cols-3 gap-2 bg-stone-300 p-2 rounded-lg shadow-2xl flex-shrink-0">
                        <!-- Row 1 -->
                        <div onclick="showStarDetail(4)"
                            class="magic-square-cell bg-green-100 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-green-800 hover:bg-green-200">
                            4<span class="text-xs block ml-1">æœ¨</span></div>
                        <div onclick="showStarDetail(9)"
                            class="magic-square-cell bg-red-100 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-red-800 hover:bg-red-200">
                            9<span class="text-xs block ml-1">ç«</span></div>
                        <div onclick="showStarDetail(2)"
                            class="magic-square-cell bg-yellow-100 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-yellow-800 hover:bg-yellow-200">
                            2<span class="text-xs block ml-1">åœŸ</span></div>
                        <!-- Row 2 -->
                        <div onclick="showStarDetail(3)"
                            class="magic-square-cell bg-green-200 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-green-900 hover:bg-green-300">
                            3<span class="text-xs block ml-1">æœ¨</span></div>
                        <div onclick="showStarDetail(5)"
                            class="magic-square-cell bg-yellow-300 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-yellow-900 hover:bg-yellow-400 border-2 border-jp-gold">
                            5<span class="text-xs block ml-1">åœŸ</span></div>
                        <div onclick="showStarDetail(7)"
                            class="magic-square-cell bg-orange-100 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-orange-800 hover:bg-orange-200">
                            7<span class="text-xs block ml-1">é‡‘</span></div>
                        <!-- Row 3 -->
                        <div onclick="showStarDetail(8)"
                            class="magic-square-cell bg-yellow-100 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-yellow-800 hover:bg-yellow-200">
                            8<span class="text-xs block ml-1">åœŸ</span></div>
                        <div onclick="showStarDetail(1)"
                            class="magic-square-cell bg-blue-100 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-blue-800 hover:bg-blue-200">
                            1<span class="text-xs block ml-1">æ°´</span></div>
                        <div onclick="showStarDetail(6)"
                            class="magic-square-cell bg-gray-200 flex items-center justify-center text-2xl font-bold cursor-pointer rounded text-gray-800 hover:bg-gray-300">
                            6<span class="text-xs block ml-1">é‡‘</span></div>
                    </div>

                    <div id="star-detail-panel"
                        class="w-full max-w-md bg-stone-50 p-6 rounded border border-stone-200 min-h-[16rem]">
                        <h3 class="text-xl font-bold text-jp-indigo mb-2" id="detail-title">æ•°å­—ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„</h3>
                        <p class="text-sm text-gray-600 mb-4" id="detail-desc">
                            å·¦ã®é­”æ³•é™£ï¼ˆå¾Œå¤©å®šä½ç›¤ï¼‰ã®æ•°å­—ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãã‚Œãã‚Œã®æ˜ŸãŒæŒã¤æ„å‘³ã€å¯¾å¿œã™ã‚‹è‡ªç„¶ç¾è±¡ã€æ–¹ä½ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br><br>
                            ä¸­å¤®ã®ã€Œ5ã€ã¯ã€Œå¸ç‹ã€ã®ä½ç½®ã¨ã•ã‚Œã€å‘¨å›²ã®8ã¤ã®æ˜Ÿã‚’æ”¯é…ã—ã¾ã™ã€‚ã“ã‚ŒãŒã€Œäº”é»„åœŸæ˜Ÿã€ã®å¼·åŠ›ãªä½œç”¨ã®æ ¹æ‹ ã§ã™ã€‚
                        </p>
                        <div id="detail-metrics" class="hidden grid grid-cols-2 gap-2 text-sm">
                            <div class="bg-white p-2 rounded shadow-sm"><span
                                    class="block text-xs text-gray-400">äº”è¡Œ</span><span id="metric-element"
                                    class="font-bold">-</span></div>
                            <div class="bg-white p-2 rounded shadow-sm"><span
                                    class="block text-xs text-gray-400">å®šä½ç½®</span><span id="metric-direction"
                                    class="font-bold">-</span></div>
                            <div class="bg-white p-2 rounded shadow-sm col-span-2"><span
                                    class="block text-xs text-gray-400">è±¡æ„ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰</span><span id="metric-keywords"
                                    class="font-bold">-</span></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Part -->
            <div>
                <h2 class="text-2xl font-serif font-bold text-jp-indigo border-l-4 border-jp-gold pl-4 mb-6">æ­´å²ã¨å¤‰é·</h2>
                <div class="relative pl-8 md:pl-0">
                    <!-- Timeline Line (Mobile: Left, Desktop: Center) -->
                    <div class="timeline-line hidden md:block"></div>
                    <div class="absolute left-8 top-0 bottom-0 w-0.5 bg-gray-300 md:hidden"></div>

                    <!-- Timeline Item 1 -->
                    <div class="mb-8 flex flex-col md:flex-row items-center w-full">
                        <div class="w-full md:w-5/12 md:text-right pr-0 md:pr-8 mb-2 md:mb-0 order-1">
                            <h3 class="font-bold text-lg text-jp-indigo">å¤ä»£ä¸­å›½ï¼ˆå¤ãƒ»æ®·æ™‚ä»£ï¼‰</h3>
                            <p class="text-sm text-gray-600">ç´„4000å¹´å‰ã€æ²»æ°´å·¥äº‹ã®éš›ã«äº€ã®ç”²ç¾…ã«è¦‹ã¤ã‹ã£ãŸæ¨¡æ§˜ã‹ã‚‰ã€Œæ´›æ›¸ã€ãŒç™ºè¦‹ã•ã‚Œã‚‹ã€‚</p>
                        </div>
                        <div
                            class="w-6 h-6 bg-jp-gold rounded-full border-4 border-white shadow absolute left-5 md:left-1/2 md:transform md:-translate-x-1/2 z-10 order-2">
                        </div>
                        <div class="w-full md:w-5/12 pl-8 order-3 hidden md:block"></div>
                    </div>

                    <!-- Timeline Item 2 -->
                    <div class="mb-8 flex flex-col md:flex-row items-center w-full">
                        <div class="w-full md:w-5/12 order-1 hidden md:block"></div>
                        <div
                            class="w-6 h-6 bg-jp-indigo rounded-full border-4 border-white shadow absolute left-5 md:left-1/2 md:transform md:-translate-x-1/2 z-10 order-2">
                        </div>
                        <div class="w-full md:w-5/12 pl-0 md:pl-8 mb-2 md:mb-0 order-3">
                            <h3 class="font-bold text-lg text-jp-indigo">æ—¥æœ¬ã¸ã®ä¼æ¥ï¼ˆæ¨å¤å¤©çš‡æ™‚ä»£ï¼‰</h3>
                            <p class="text-sm text-gray-600">550ã€œ600å¹´é ƒã€æš¦ã‚„æ˜“ã¨ã¨ã‚‚ã«æ—¥æœ¬ã¸ä¼æ¥ã€‚é™°é™½å¯®ã§æ‰±ã‚ã‚Œã‚‹å›½å®¶æ©Ÿå¯†ã®å­¦å•ã¨ãªã‚‹ã€‚</p>
                        </div>
                    </div>

                    <!-- Timeline Item 3 -->
                    <div class="mb-8 flex flex-col md:flex-row items-center w-full">
                        <div class="w-full md:w-5/12 md:text-right pr-0 md:pr-8 mb-2 md:mb-0 order-1">
                            <h3 class="font-bold text-lg text-jp-indigo">æ±Ÿæˆ¸æ™‚ä»£</h3>
                            <p class="text-sm text-gray-600">ã€Œå®¶ç›¸ã€ã¨ã—ã¦ä¸€èˆ¬åº¶æ°‘ã«ã‚‚æµ¸é€ã—å§‹ã‚ã‚‹ã€‚æ¾ä¸‹æ‘å¡¾ãªã©ã§ã‚‚æˆ¦ç•¥ã¨ã—ã¦å­¦ã°ã‚Œã‚‹ã€‚</p>
                        </div>
                        <div
                            class="w-6 h-6 bg-jp-indigo rounded-full border-4 border-white shadow absolute left-5 md:left-1/2 md:transform md:-translate-x-1/2 z-10 order-2">
                        </div>
                        <div class="w-full md:w-5/12 order-3 hidden md:block"></div>
                    </div>

                    <!-- Timeline Item 4 -->
                    <div class="mb-8 flex flex-col md:flex-row items-center w-full">
                        <div class="w-full md:w-5/12 order-1 hidden md:block"></div>
                        <div
                            class="w-6 h-6 bg-jp-accent rounded-full border-4 border-white shadow absolute left-5 md:left-1/2 md:transform md:-translate-x-1/2 z-10 order-2">
                        </div>
                        <div class="w-full md:w-5/12 pl-0 md:pl-8 mb-2 md:mb-0 order-3">
                            <h3 class="font-bold text-lg text-jp-indigo">å¤§æ­£ãƒ»æ˜æ²»ï¼ˆåœ’ç”°çœŸæ¬¡éƒï¼‰</h3>
                            <p class="text-sm text-gray-600">åœ’ç”°çœŸæ¬¡éƒãŒã€Œæ°—å­¦ã€ã¨ã—ã¦ä½“ç³»åŒ–ã€‚è¤‡é›‘ãªç†è«–ã‚’æ•´ç†ã—ã€ç¾åœ¨æ™®åŠã—ã¦ã„ã‚‹ã€Œä¹æ˜Ÿæ°—å­¦ã€ã®åŸºç¤ã‚’ç¢ºç«‹ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 4: PRACTICE (CALCULATOR) -->
        <div id="view-practice" class="hidden animate-fade-in">
            <div class="mb-8">
                <h2 class="text-2xl font-serif font-bold text-jp-indigo border-l-4 border-jp-gold pl-4 mb-4">
                    ã€å®Ÿè·µã€‘ã‚ãªãŸã®æœ¬å‘½æ˜Ÿã‚’èª¿ã¹ã‚‹</h2>
                <p class="leading-relaxed text-jp-text mb-6">
                    ä¹æ˜Ÿæ°—å­¦ã®é‘‘å®šæ‰‹é †ã®ç¬¬ä¸€æ­©ã¯ã€è‡ªåˆ†ã®ã€Œæœ¬å‘½æ˜Ÿï¼ˆã»ã‚“ã‚ã„ã›ã„ï¼‰ã€ã‚’çŸ¥ã‚‹ã“ã¨ã§ã™ã€‚
                    ç”Ÿã¾ã‚ŒãŸå¹´ï¼ˆè¥¿æš¦ï¼‰ã‹ã‚‰ã€ã‚ãªãŸãŒã©ã®æ˜Ÿã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¸¯ã³ã¦ç”Ÿã¾ã‚Œã¦ããŸã‹ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
                </p>
                <div class="bg-yellow-50 border border-yellow-200 rounded p-4 text-sm text-yellow-800 mb-6">
                    <strong>âš ï¸ é‡è¦ï¼š1æœˆ1æ—¥ã€œ2æœˆ3æ—¥ç”Ÿã¾ã‚Œã®æ–¹ã¸</strong><br>
                    ä¹æ˜Ÿæ°—å­¦ã®1å¹´ã¯ã€Œç«‹æ˜¥ï¼ˆ2æœˆ4æ—¥é ƒï¼‰ã€ã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚<br>
                    2æœˆ3æ—¥ä»¥å‰ï¼ˆç¯€åˆ†ã¾ã§ï¼‰ã«ç”Ÿã¾ã‚ŒãŸæ–¹ã¯ã€<strong>ã€Œå‰å¹´ã®æ˜Ÿã€</strong>ã¨ãªã‚Šã¾ã™ã€‚
                </div>
            </div>

            <div class="bg-white p-8 rounded-xl shadow-lg max-w-lg mx-auto border border-stone-200">
                <div class="mb-6 text-center">
                    <label for="birthYear" class="block text-gray-700 font-bold mb-2">ç”Ÿã¾ã‚ŒãŸå¹´ï¼ˆè¥¿æš¦ï¼‰ã‚’å…¥åŠ›</label>
                    <div class="flex justify-center items-center gap-2">
                        <input type="number" id="birthYear" placeholder="ä¾‹: 1990"
                            class="shadow appearance-none border rounded w-32 py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-jp-indigo text-center text-lg">
                        <span class="text-gray-500">å¹´</span>
                    </div>

                    <div class="mt-4 flex items-center justify-center gap-2 text-sm text-gray-600">
                        <input type="checkbox" id="beforeSetsubun" class="form-checkbox h-4 w-4 text-jp-indigo">
                        <label for="beforeSetsubun" class="cursor-pointer select-none">1æœˆ1æ—¥ ã€œ 2æœˆ3æ—¥ç”Ÿã¾ã‚Œ</label>
                    </div>

                    <button onclick="calculateStar()"
                        class="mt-6 bg-jp-indigo hover:bg-blue-900 text-white font-bold py-3 px-8 rounded-full shadow transition-transform transform hover:-translate-y-1">
                        é‘‘å®šã™ã‚‹
                    </button>
                </div>

                <!-- Result Display -->
                <div id="result-area" class="hidden mt-8 border-t pt-6 animate-fade-in">
                    <div class="text-center">
                        <p class="text-gray-500 text-sm mb-1">ã‚ãªãŸã®æœ¬å‘½æ˜Ÿã¯</p>
                        <h3 id="result-star-name" class="text-3xl font-serif font-bold text-jp-indigo mb-2">-</h3>
                        <p id="result-element" class="text-sm font-bold text-jp-gold mb-4">-</p>
                    </div>

                    <div class="bg-stone-50 rounded p-4 text-left">
                        <h4 class="font-bold text-gray-800 mb-2 border-b pb-1">åŸºæœ¬æ€§æ ¼ãƒ»ç‰¹æ€§</h4>
                        <p id="result-personality" class="text-sm text-gray-700 leading-relaxed">-</p>
                    </div>

                    <div class="mt-4 grid grid-cols-2 gap-4">
                        <div class="bg-white p-3 rounded shadow-sm text-center">
                            <span class="block text-xs text-gray-400">ãƒ©ãƒƒã‚­ãƒ¼ã‚«ãƒ©ãƒ¼</span>
                            <span id="result-color" class="font-bold text-jp-indigo">-</span>
                        </div>
                        <div class="bg-white p-3 rounded shadow-sm text-center">
                            <span class="block text-xs text-gray-400">è±¡å¾´ã™ã‚‹è‡ªç„¶</span>
                            <span id="result-nature" class="font-bold text-jp-indigo">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-stone-800 text-stone-400 py-8 text-center text-sm mt-8">
        <div class="container mx-auto px-4">
            <p class="mb-2">ä¹æ˜Ÿæ°—å­¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¬ãƒãƒ¼ãƒˆ</p>
            <p>â€»æœ¬ãƒ¬ãƒãƒ¼ãƒˆã®é‘‘å®šçµæœã¯ä¸€èˆ¬çš„ãªå‚¾å‘ã‚’ç¤ºã™ã‚‚ã®ã§ã™ã€‚</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- Data Definitions ---
        const starData = {
            1: { name: "ä¸€ç™½æ°´æ˜Ÿ (ã„ã£ã±ãã™ã„ã›ã„)", element: "æ°´", color: "ç™½ãƒ»é»’", nature: "æ°´ãƒ»é›¨", keywords: "æŸ”è»Ÿã€çŸ¥æ€§ã€ç§˜å¯†ã€è‹¦åŠ´ã€å§‹ã¾ã‚Š", personality: "æŸ”è»Ÿã§é©å¿œåŠ›ãŒé«˜ã„ãŒã€èŠ¯ã¯å¼·ã„ã€‚äººå½“ãŸã‚Šã¯è‰¯ã„ãŒç§˜å¯†ä¸»ç¾©ãªä¸€é¢ã‚‚ã€‚è‹¦åŠ´ã‚’ä¹—ã‚Šè¶Šãˆã¦å¤§æˆã™ã‚‹ã‚¿ã‚¤ãƒ—ã€‚", direction: "åŒ—" },
            2: { name: "äºŒé»’åœŸæ˜Ÿ (ã˜ã“ãã©ã›ã„)", element: "åœŸ", color: "é»’ãƒ»é»„", nature: "å¤§åœ°ãƒ»æ¯", keywords: "è‚²æˆã€çœŸé¢ç›®ã€åŠªåŠ›ã€å®¶åº­ã€è£œä½", personality: "çœŸé¢ç›®ã§æ¸©åšã€æ¯ã®ã‚ˆã†ãªå„ªã—ã•ã‚’æŒã¤ã€‚æ´¾æ‰‹ã•ã¯ãªã„ãŒã€å …å®ŸãªåŠªåŠ›ã§ä¿¡é ¼ã‚’å‹ã¡å–ã‚‹å¤§å™¨æ™©æˆå‹ã€‚", direction: "å—è¥¿" },
            3: { name: "ä¸‰ç¢§æœ¨æ˜Ÿ (ã•ã‚“ãºãã‚‚ãã›ã„)", element: "æœ¨", color: "é’", nature: "é›·ãƒ»è‹¥æœ¨", keywords: "ç™ºå±•ã€è‹¥ã•ã€æ´»å‹•ã€éŸ³ã€çŸ­æ°—", personality: "æ˜ã‚‹ãæ´»å‹•çš„ã§ã€æ–°ã—ã„ã‚‚ã®ãŒå¥½ãã€‚æ„Ÿæƒ…è¡¨ç¾ãŒè±Šã‹ã ãŒã€å°‘ã—ã›ã£ã‹ã¡ãªã¨ã“ã‚ã‚‚ã€‚å£°ãŒå¤§ããå…ƒæ°—ãªäººãŒå¤šã„ã€‚", direction: "æ±" },
            4: { name: "å››ç·‘æœ¨æ˜Ÿ (ã—ã‚ãã‚‚ãã›ã„)", element: "æœ¨", color: "ç·‘", nature: "é¢¨ãƒ»å¤§æœ¨", keywords: "ä¿¡ç”¨ã€æ•´ã†ã€ç¤¾äº¤ã€è¿·ã„ã€é æ–¹", personality: "ç¤¾äº¤çš„ã§äººå½“ãŸã‚ŠãŒè‰¯ãã€èª°ã‹ã‚‰ã‚‚å¥½ã‹ã‚Œã‚‹ã€‚é¢¨ã®ã‚ˆã†ã«çˆ½ã‚„ã‹ã ãŒã€å„ªæŸ”ä¸æ–­ã«ãªã‚ŠãŒã¡ãªä¸€é¢ã‚‚ã€‚", direction: "å—æ±" },
            5: { name: "äº”é»„åœŸæ˜Ÿ (ã”ãŠã†ã©ã›ã„)", element: "åœŸ", color: "é»„", nature: "è’é‡ãƒ»å¸ç‹", keywords: "æ”¯é…ã€ç ´å£Šã€å†ç”Ÿã€ä¸­å¿ƒã€å¼·çƒˆ", personality: "åœ§å€’çš„ãªãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã¨ãƒã‚¤ã‚¿ãƒªãƒ†ã‚£ã‚’æŒã¤ã€‚å‘¨å›²ã‚’å·»ãè¾¼ã‚€åŠ›ãŒå¼·ãã€å‰å‡¶ã®æ³¢ãŒæ¿€ã—ã„ãƒ‰ãƒ©ãƒãƒãƒƒã‚¯ãªäººç”Ÿã€‚", direction: "ä¸­å¤®" },
            6: { name: "å…­ç™½é‡‘æ˜Ÿ (ã‚ã£ã±ããã‚“ã›ã„)", element: "é‡‘", color: "ç™½ãƒ»éŠ€", nature: "å¤©ãƒ»åŸçŸ³", keywords: "é«˜è²´ã€å®Œæˆã€æ´»å‹•ã€æ¨©å¨ã€ãƒ—ãƒ©ã‚¤ãƒ‰", personality: "æ­£ç¾©æ„ŸãŒå¼·ãã€å®Œç’§ä¸»ç¾©ã€‚ãƒªãƒ¼ãƒ€ãƒ¼ã®è³‡è³ªãŒã‚ã‚‹ãŒã€ãƒ—ãƒ©ã‚¤ãƒ‰ãŒé«˜ãé ‘å›ºã«è¦‹ã‚‰ã‚Œã‚‹ã“ã¨ã‚‚ã€‚è²¬ä»»æ„ŸãŒå¼·ã„ã€‚", direction: "åŒ—è¥¿" },
            7: { name: "ä¸ƒèµ¤é‡‘æ˜Ÿ (ã—ã¡ã›ããã‚“ã›ã„)", element: "é‡‘", color: "èµ¤ãƒ»æ©™", nature: "æ²¢ãƒ»ç²¾éŒ¬", keywords: "æ‚¦ã³ã€é‡‘é‹ã€é›„å¼ã€ä¸è¶³ã€ç¤¾äº¤", personality: "æ„›å¬ŒãŒã‚ã‚Šã€è©±è¡“ã«é•·ã‘ãŸäººæ°—è€…ã€‚æ¥½ã—ã„ã“ã¨ãŒå¤§å¥½ãã€‚é‡‘é‹ã«æµã¾ã‚Œã‚‹ãŒã€ä¸€è¨€å¤šã„å¤±æ•—ã«ã¯æ³¨æ„ã€‚", direction: "è¥¿" },
            8: { name: "å…«ç™½åœŸæ˜Ÿ (ã¯ã£ã±ãã©ã›ã„)", element: "åœŸ", color: "ç™½ãƒ»èŒ¶", nature: "å±±", keywords: "å¤‰åŒ–ã€åœæ­¢ã€ç¶™æ‰¿ã€è“„ç©ã€é«˜å±±", personality: "ã©ã£ã—ã‚Šã¨ã—ãŸå±±ã®ã‚ˆã†ã«è½ã¡ç€ã„ã¦ã„ã‚‹ã€‚æ„å¿—ãŒå›ºãã€ä¸€åº¦æ±ºã‚ãŸã“ã¨ã¯ã‚„ã‚ŠæŠœãã€‚å¤‰åŒ–ã®å¤šã„äººç”Ÿã‚’é€ã‚‹å‚¾å‘ã€‚", direction: "åŒ—æ±" },
            9: { name: "ä¹ç´«ç«æ˜Ÿ (ãã‚…ã†ã—ã‹ã›ã„)", element: "ç«", color: "ç´«ãƒ»èµ¤", nature: "ç«ãƒ»å¤ªé™½", keywords: "åèª‰ã€çŸ¥æµã€é›¢åˆ¥ã€è¯ã‚„ã‹ã€æƒ…ç†±", personality: "ç¾çš„ã‚»ãƒ³ã‚¹ã«å„ªã‚Œã€è¯ã‚„ã‹ã§ç›®ç«‹ã¤å­˜åœ¨ã€‚é ­ã®å›è»¢ãŒé€Ÿã„ãŒã€ç†±ã—ã‚„ã™ãå†·ã‚ã‚„ã™ã„ã¨ã“ã‚ãŒã‚ã‚‹ã€‚", direction: "å—" }
        };

        // --- Interaction Logic ---

        // 1. Tab Switching
        function switchTab(tabId) {
            // Hide all views
            ['overview', 'analysis', 'logic', 'practice'].forEach(id => {
                document.getElementById(`view-${id}`).classList.add('hidden');
                document.getElementById(`nav-${id}`).classList.replace('tab-active', 'tab-inactive');
                document.getElementById(`nav-${id}`).classList.remove('font-bold');
            });

            // Show selected view
            document.getElementById(`view-${tabId}`).classList.remove('hidden');
            const activeNav = document.getElementById(`nav-${tabId}`);
            activeNav.classList.replace('tab-inactive', 'tab-active');

            // Trigger chart render if analysis tab is chosen and chart not yet drawn
            if (tabId === 'analysis' && !window.suitabilityChartInstance) {
                renderChart();
            }
        }

        // 2. Logic: Show Star Details
        function showStarDetail(number) {
            const data = starData[number];
            document.getElementById('detail-title').innerText = `${number}: ${data.name}`;
            document.getElementById('detail-desc').innerText = data.personality;
            document.getElementById('detail-metrics').classList.remove('hidden');

            document.getElementById('metric-element').innerText = data.element;
            document.getElementById('metric-direction').innerText = data.direction;
            document.getElementById('metric-keywords').innerText = data.keywords;
        }

        // 3. Calculator Logic
        function calculateStar() {
            const yearInput = document.getElementById('birthYear').value;
            const isBeforeSetsubun = document.getElementById('beforeSetsubun').checked;

            if (!yearInput) {
                alert('ç”Ÿã¾ã‚ŒãŸå¹´ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            let year = parseInt(yearInput);

            // Adjust year for Setsubun (If born Jan 1 - Feb 3, count as previous year)
            if (isBeforeSetsubun) {
                year -= 1;
            }

            // Calculation Logic:
            // Sum all digits until single digit, then subtract from 11.
            // Simplified Formula: (11 - (Year % 9)) % 9. If result is 0, it is 9.
            // Let's use standard reduction method
            let sum = 0;
            // Sum of digits
            let yStr = year.toString();
            for (let i = 0; i < yStr.length; i++) sum += parseInt(yStr[i]);

            // Reduce to single digit
            while (sum > 9) {
                let sStr = sum.toString();
                sum = 0;
                for (let i = 0; i < sStr.length; i++) sum += parseInt(sStr[i]);
            }

            let starNum = 11 - sum;
            if (starNum > 9) starNum -= 9;
            if (starNum === 0) starNum = 9; // Should not happen with 11-sum logic usually but safe guard

            // Specific check:
            // 1990 -> 1+9+9+0 = 19 -> 10 -> 1. 11-1 = 1 (Ippaku) Correct.
            // 1985 -> 1+9+8+5 = 23 -> 5. 11-5 = 6 (Roppaku) Correct.

            const result = starData[starNum];

            // Display Result
            document.getElementById('result-area').classList.remove('hidden');
            document.getElementById('result-star-name').innerText = result.name;
            document.getElementById('result-element').innerText = `äº”è¡Œï¼š${result.element}`;
            document.getElementById('result-personality').innerText = result.personality;
            document.getElementById('result-color').innerText = result.color;
            document.getElementById('result-nature').innerText = result.nature;
        }

        // 4. Chart.js Implementation
        function renderChart() {
            const ctx = document.getElementById('suitabilityChart').getContext('2d');

            // Data for "What it's good at" vs "What it's bad at"
            // Categories: å¼•è¶Šã—/æ–¹ä½ (Moving), ç›¸æ€§ (Compatibility), æ€§æ ¼åˆ†æ (Personality), å¹´é–“ã®é‹å‹¢ (Annual Luck), æ—¥ã€…ã®å‰å‡¶ (Daily Luck), ç›¸æ‰‹ã®æ°—æŒã¡ (Feelings), å…·ä½“çš„äº‹è±¡ (Specific Outcomes)

            window.suitabilityChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['å‰æ–¹ä½ãƒ»å¼•è¶Šã—', 'å¹´é–“ã®é‹æ°—', 'æ€§æ ¼ãƒ»è³‡è³ª', 'ç›¸æ€§è¨ºæ–­', 'æ—¥ã€…ã®å‰å‡¶', 'ç›¸æ‰‹ã®å¿ƒç†', 'å…·ä½“çš„äºˆè¨€'],
                    datasets: [{
                        label: 'ä¹æ˜Ÿæ°—å­¦ã®é©åˆåº¦ (10ç‚¹æº€ç‚¹)',
                        data: [10, 9, 8, 8, 6, 3, 2],
                        backgroundColor: [
                            'rgba(30, 58, 95, 0.9)', // Indigo
                            'rgba(30, 58, 95, 0.8)',
                            'rgba(30, 58, 95, 0.7)',
                            'rgba(30, 58, 95, 0.6)',
                            'rgba(212, 175, 55, 0.6)', // Gold (Medium)
                            'rgba(194, 74, 74, 0.4)', // Red (Low)
                            'rgba(194, 74, 74, 0.4)'
                        ],
                        borderColor: [
                            '#1e3a5f', '#1e3a5f', '#1e3a5f', '#1e3a5f', '#d4af37', '#c24a4a', '#c24a4a'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y', // Horizontal bar chart for better label readability
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 10,
                            grid: { color: '#f0f0f0' },
                            ticks: { font: { family: "'Noto Sans JP', sans-serif" } }
                        },
                        y: {
                            grid: { display: false },
                            ticks: { font: { family: "'Noto Sans JP', sans-serif", weight: 'bold' } }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const comments = [
                                        "æœ€å¼·ã€‚æœ€å¤§ã®ç‰¹å¾´ã§ã‚ã‚Šç‹¬å£‡å ´ã€‚",
                                        "9å¹´ã‚µã‚¤ã‚¯ãƒ«ã®ãƒã‚¤ã‚ªãƒªã‚ºãƒ æŠŠæ¡ã«æœ€é©ã€‚",
                                        "æœ¬è³ªçš„ãªæ°—è³ªç†è§£ã«éå¸¸ã«æœ‰åŠ¹ã€‚",
                                        "ãŠäº’ã„ã®æ°—ã®ç›¸å…‹ãƒ»ç›¸ç”Ÿã§è«–ç†çš„ã«è¨ºæ–­ã€‚",
                                        "æ—¥ç›¤ã‚‚ã‚ã‚‹ãŒã€é•·æœŸçš„ãªè¦–ç‚¹ã®æ–¹ãŒå¾—æ„ã€‚",
                                        "è‹¦æ‰‹ã€‚ã€Œä»Šã€ã®æºã‚Œå‹•ãæ„Ÿæƒ…ã¯ã‚¿ãƒ­ãƒƒãƒˆç­‰ã¸ã€‚",
                                        "ã€Œæ˜æ—¥è²¡å¸ƒã‚’è½ã¨ã™ã‹ï¼Ÿã€ç­‰ã¯ã‚ã‹ã‚‰ãªã„ã€‚"
                                    ];
                                    return `é©åˆåº¦: ${context.raw}/10 - ${comments[context.dataIndex]}`;
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>

</html>