<!DOCTYPE html>
<html lang="ja" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>紫微斗数：天命を解き明かす皇帝の星学</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- 共通CSS -->
    <link rel="stylesheet" href="../../assets/common.css">
    <style>
        body {
            background-color: #FDFBF7;
            color: #1e1b4b;
            font-family: 'Noto Sans JP', sans-serif;
            line-height: 1.8;
        }

        .serif {
            font-family: 'Noto Serif JP', serif;
        }

        .hero-bg {
            background-color: #FDFBF7;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(91, 33, 182, 0.03) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(79, 70, 229, 0.03) 0%, transparent 40%);
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            border-radius: 1.5rem;
        }

        .active-tab {
            border-bottom: 2px solid #4f46e5;
            color: #4f46e5;
            font-weight: 600;
        }

        .palace-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            border: 1px solid rgba(79, 70, 229, 0.05);
            background: #fff;
        }

        .palace-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05);
            border-color: #4f46e5;
        }

        .palace-card.active {
            background-color: #f8fafc;
            border-color: #4f46e5;
            box-shadow: 0 0 0 1px #4f46e5;
        }

        .star-link {
            transition: all 0.25s ease;
            color: #64748b;
            position: relative;
        }

        .star-link:hover {
            color: #4f46e5;
            background-color: rgba(79, 70, 229, 0.05);
            padding-left: 1rem;
        }

        .star-link.active {
            color: #4f46e5;
            font-weight: 700;
            background-color: rgba(79, 70, 229, 0.08);
            padding-left: 1.25rem;
        }

        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 5px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #e2e8f0;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
    </style>
</head>

<body class="selection:bg-indigo-100">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="w-8 h-8 bg-indigo-900/10 rounded-lg flex items-center justify-center mr-3">
                        <i data-lucide="moon-star" class="w-5 h-5 text-indigo-900"></i>
                    </div>
                    <span class="text-2xl font-bold text-indigo-900 serif tracking-tight">紫微斗数</span>
                    <span class="ml-2 text-xs text-indigo-500 uppercase tracking-widest hidden sm:block">Zi Wei Dou
                        Shu</span>
                </div>
                <div class="hidden md:flex items-center gap-1 text-sm font-medium">
                    <a href="#calculator"
                        class="px-4 py-2 rounded-full text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition-all flex items-center gap-2">
                        <i data-lucide="sparkles" class="w-4 h-4"></i> 簡易診断
                    </a>
                    <a href="#overview"
                        class="px-4 py-2 rounded-full text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition-all flex items-center gap-2">
                        <i data-lucide="search" class="w-4 h-4"></i> 概要
                    </a>
                    <a href="#palaces"
                        class="px-4 py-2 rounded-full text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition-all flex items-center gap-2">
                        <i data-lucide="compass" class="w-4 h-4"></i> 十二宮
                    </a>
                    <a href="#stars"
                        class="px-4 py-2 rounded-full text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition-all flex items-center gap-2">
                        <i data-lucide="star" class="w-4 h-4"></i> 主星
                    </a>
                    <a href="#history-method"
                        class="px-4 py-2 rounded-full text-gray-600 hover:bg-indigo-50 hover:text-indigo-700 transition-all flex items-center gap-2">
                        <i data-lucide="history" class="w-4 h-4"></i> 歴史・鑑定法
                    </a>
                </div>
                <!-- Mobile Menu Btn -->
                <button id="mobile-menu-btn" class="md:hidden p-2 text-indigo-900 hover:bg-gray-100 rounded-lg">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-100">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#calculator"
                    class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-indigo-50">簡易診断</a>
                <a href="#overview"
                    class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-indigo-50">概要</a>
                <a href="#palaces"
                    class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-indigo-50">十二宮</a>
                <a href="#stars"
                    class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-indigo-50">主星</a>
                <a href="#history-method"
                    class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-indigo-700 hover:bg-indigo-50">歴史・鑑定法</a>
            </div>
        </div>
    </nav>

    <main>
        <!-- Hero / Calculator Section -->
        <header id="calculator" class="relative hero-bg py-20 px-4 sm:px-6 lg:px-8 border-b border-indigo-50">
            <div class="max-w-7xl mx-auto grid lg:grid-cols-2 gap-12 items-center">
                <!-- Left Column: Text Content + Calculator -->
                <div class="fade-in">
                    <div
                        class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-indigo-50 text-indigo-600 text-xs font-bold mb-6 uppercase tracking-widest">
                        <i data-lucide="sparkles" class="w-3.5 h-3.5"></i> 皇帝の星学
                    </div>
                    <h1 class="text-4xl md:text-6xl font-extrabold text-[#111827] leading-tight serif mb-6">
                        紫微斗数<br><span class="text-indigo-600">皇帝の星学</span>
                    </h1>
                    <p class="text-lg text-slate-500 max-w-xl leading-relaxed mb-10">
                        紫微斗数は、あなたが生まれた瞬間の天空を支配する星々の配置を読み解き、人生の設計図を可視化する「皇帝の占術」です。その的中率の高さから、かつては禁域の秘術とされていました。
                    </p>

                    <!-- Icons -->
                    <div class="flex items-center gap-4 mb-10">
                        <div class="flex -space-x-2">
                            <div
                                class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center border-2 border-white text-white">
                                <i data-lucide="moon-star" class="w-5 h-5"></i>
                            </div>
                            <div
                                class="w-10 h-10 rounded-full bg-purple-600 flex items-center justify-center border-2 border-white text-white">
                                <i data-lucide="compass" class="w-5 h-5"></i>
                            </div>
                            <div
                                class="w-10 h-10 rounded-full bg-indigo-400 flex items-center justify-center border-2 border-white text-white">
                                <i data-lucide="crown" class="w-5 h-5"></i>
                            </div>
                        </div>
                        <span class="text-sm font-medium text-slate-400 italic">Celestial destiny blueprint</span>
                    </div>
                </div>

                <!-- Right Column: Calculator Form -->
                <div class="fade-in" style="animation-delay: 0.2s;">
                    <div
                        class="bg-white p-8 rounded-[2.5rem] shadow-xl shadow-indigo-100/30 border border-indigo-100/50">
                        <h3 class="text-xl font-bold text-indigo-950 mb-8 flex items-center gap-3">
                            <i data-lucide="compass" class="w-6 h-6 text-indigo-600"></i>
                            パーソナル天命診断
                        </h3>
                        <div class="space-y-6">
                            <!-- Date Selection -->
                            <div class="space-y-3">
                                <label
                                    class="text-xs font-bold text-slate-400 uppercase tracking-widest ml-1">生年月日</label>
                                <div class="grid grid-cols-3 gap-2">
                                    <select id="birth-year"
                                        class="bg-slate-50 border border-slate-200 rounded-xl px-2 py-3 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none w-full"></select>
                                    <select id="birth-month"
                                        class="bg-slate-50 border border-slate-200 rounded-xl px-2 py-3 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none w-full"></select>
                                    <select id="birth-day"
                                        class="bg-slate-50 border border-slate-200 rounded-xl px-2 py-3 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none w-full"></select>
                                </div>
                            </div>
                            <!-- Time Selection -->
                            <div class="space-y-3">
                                <label
                                    class="text-xs font-bold text-slate-400 uppercase tracking-widest ml-1">出生時間（十二刻）</label>
                                <div class="relative">
                                    <select id="birth-hour"
                                        class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 appearance-none transition-all">
                                        <option value="1">子時 (23:00 - 01:00)</option>
                                        <option value="2">丑時 (01:00 - 03:00)</option>
                                        <option value="3">寅時 (03:00 - 05:00)</option>
                                        <option value="4">卯時 (05:00 - 07:00)</option>
                                        <option value="5">辰時 (07:00 - 09:00)</option>
                                        <option value="6">巳時 (09:00 - 11:00)</option>
                                        <option value="7">午時 (11:00 - 13:00)</option>
                                        <option value="8">未時 (13:00 - 15:00)</option>
                                        <option value="9">申時 (15:00 - 17:00)</option>
                                        <option value="10">酉時 (17:00 - 19:00)</option>
                                        <option value="11">戌時 (19:00 - 21:00)</option>
                                        <option value="12">亥時 (21:00 - 23:00)</option>
                                    </select>
                                    <i data-lucide="chevron-down"
                                        class="absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"></i>
                                </div>
                            </div>
                            <button onclick="diagnose()"
                                class="w-full py-5 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-2xl shadow-lg shadow-indigo-200 transition-all transform active:scale-95 flex items-center justify-center gap-2 group">
                                天命を解読する
                                <i data-lucide="arrow-right"
                                    class="w-5 h-5 transition-transform group-hover:translate-x-1"></i>
                            </button>

                            <p class="text-[10px] text-slate-400 leading-relaxed">
                                ※数分の違いで命盤が変わるため、出生時間の正確性が重要です
                            </p>
                        </div>

                        <!-- Diagnosis Result area -->
                        <div id="diagnosis-result"
                            class="hidden mt-10 p-8 bg-indigo-50/50 rounded-3xl border border-indigo-100 shadow-inner">
                            <div class="flex items-center justify-between mb-6">
                                <span
                                    class="text-[10px] font-black text-indigo-400 uppercase tracking-[0.2em]">Diagnosis
                                    Success</span>
                                <div class="flex items-center gap-2">
                                    <i data-lucide="star" class="w-4 h-4 text-indigo-600 fill-indigo-600"></i>
                                    <span id="res-star-name" class="text-2xl font-bold text-indigo-950 serif"></span>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-2xl mb-6 text-[15px] text-slate-600 leading-relaxed border border-indigo-50 shadow-sm"
                                id="res-brief">
                            </div>
                            <div class="grid grid-cols-2 gap-4 text-center mb-8">
                                <div class="p-4 bg-white rounded-2xl border border-indigo-50 shadow-sm">
                                    <span
                                        class="text-[10px] text-slate-400 block uppercase tracking-widest mb-1">主室（命宮）</span>
                                    <span id="res-main-palace" class="font-black text-indigo-900">--</span>
                                </div>
                                <div class="p-4 bg-white rounded-2xl border border-indigo-50 shadow-sm">
                                    <span
                                        class="text-[10px] text-slate-400 block uppercase tracking-widest mb-1">五行局（Element）</span>
                                    <span id="res-element" class="font-black text-indigo-900">--</span>
                                </div>
                            </div>

                            <!-- Calculation Logic Display -->
                            <div class="mt-6 pt-6 border-t border-indigo-100">
                                <h4
                                    class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center">
                                    <i data-lucide="terminal" class="w-3 h-3 mr-2"></i> Calculation Logic
                                </h4>
                                <div id="calculation-steps"
                                    class="space-y-3 text-[11px] text-slate-500 leading-relaxed">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- About Section -->
        <section id="overview" class="py-24 bg-white border-y border-slate-100 px-4 sm:px-6 lg:px-8 scroll-mt">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-20">
                    <div
                        class="inline-block px-4 py-1.5 rounded-full bg-indigo-50 text-indigo-600 text-xs font-bold mb-4 tracking-widest uppercase">
                        Overview</div>
                    <h2 class="text-4xl font-extrabold text-indigo-950 serif mb-6">命術の最高峰、紫微斗数</h2>
                    <p class="text-lg text-slate-500 max-w-2xl mx-auto leading-relaxed">
                        中国発祥の「皇帝占星術」。生年月日と出生時間に基づき、100以上の星々が描き出す「命盤（めいばん）」を通じて、個人の多面的な宇宙を詳細に分析します。
                    </p>
                </div>
                <div class="grid lg:grid-cols-2 gap-16 items-center">
                    <div class="space-y-10">
                        <div class="flex gap-6 items-start group">
                            <div
                                class="w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center shrink-0 shadow-sm transition-transform group-hover:scale-110">
                                <i data-lucide="layers" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-indigo-950 mb-2">驚異の解像度</h4>
                                <p class="text-slate-600 leading-relaxed">
                                    12の「宮」が人生のあらゆる側面（性格、財産、配偶者、仕事、健康など）を網羅し、立体的な人生のシナリオを描き出します。</p>
                            </div>
                        </div>
                        <div class="flex gap-6 items-start group">
                            <div
                                class="w-14 h-14 bg-purple-50 text-purple-600 rounded-2xl flex items-center justify-center shrink-0 shadow-sm transition-transform group-hover:scale-110">
                                <i data-lucide="trending-up" class="w-7 h-7"></i>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-indigo-950 mb-2">精密なタイムライン</h4>
                                <p class="text-slate-600 leading-relaxed">
                                    10年ごとの「大限」、1年ごとの「太歳」により、いつどこで何が起こるかという時期判断と具体的な行動指針を提供します。</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-indigo-50/50 p-10 rounded-[3rem] border border-indigo-100/50 shadow-inner">
                        <h4 class="text-center text-[10px] font-black text-indigo-400 mb-8 uppercase tracking-[0.2em]">
                            占術特性分析チャート</h4>
                        <div class="h-72 relative">
                            <canvas id="capabilityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 12 Palaces Section -->
        <section id="palaces" class="py-24 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto scroll-mt">
            <div class="text-center mb-16">
                <div
                    class="inline-block px-4 py-1.5 rounded-full bg-slate-100 text-slate-500 text-xs font-bold mb-4 tracking-widest uppercase">
                    The 12 Palaces</div>
                <h2 class="text-4xl font-extrabold text-indigo-950 serif">人生の十二、運命の舞台</h2>
            </div>
            <div class="grid lg:grid-cols-2 gap-16 items-start">
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4" id="palace-grid">
                    <!-- Populated by JS -->
                </div>
                <div class="bg-white p-10 rounded-[2.5rem] shadow-xl shadow-indigo-100/20 border border-slate-100 flex flex-col justify-center min-h-[480px] transition-all duration-500"
                    id="palace-detail">
                    <div class="flex items-center gap-6 mb-8">
                        <div class="w-20 h-20 bg-indigo-50 text-indigo-600 rounded-3xl flex items-center justify-center text-4xl shadow-sm"
                            id="detail-icon">👑</div>
                        <div>
                            <h3 class="text-3xl font-bold serif text-indigo-950" id="detail-name">命宮</h3>
                            <p class="text-sm text-indigo-400 font-bold uppercase tracking-widest mt-1"
                                id="detail-yomi">Mei-kyu</p>
                        </div>
                    </div>
                    <h4 class="text-xl font-bold mb-6 text-indigo-800 leading-tight" id="detail-subtitle">運命の司令塔・あなたの本質
                    </h4>
                    <p class="text-slate-600 leading-relaxed mb-10 text-lg" id="detail-desc">
                        ここはあなたの性格、才能、容姿、そし一生の運命の土台となる場所です。ここに入る星が、あなたの「魂の輪郭」を決定づけます。
                    </p>
                    <div class="flex flex-wrap gap-3" id="detail-keywords">
                        <!-- Keywords -->
                    </div>
                </div>
            </div>
        </section>

        <!-- 14 Stars Section -->
        <section id="stars" class="py-24 bg-slate-50 border-y border-slate-100 px-4 sm:px-6 lg:px-8 scroll-mt">
            <div class="max-w-7xl mx-auto">
                <div class="grid lg:grid-cols-3 gap-16 items-start">
                    <div class="lg:col-span-1">
                        <div
                            class="inline-block px-4 py-1.5 rounded-full bg-indigo-100 text-indigo-600 text-xs font-bold mb-4 tracking-widest uppercase">
                            14 Major Stars</div>
                        <h2 class="text-4xl font-extrabold text-indigo-950 serif mb-10">輝ける十四の主星</h2>
                        <div class="space-y-2 max-h-[550px] overflow-y-auto pr-4 custom-scrollbar bg-white/50 p-4 rounded-3xl border border-slate-200/50 shadow-inner"
                            id="star-nav-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                    <div class="lg:col-span-2">
                        <div class="bg-white rounded-[3rem] p-10 md:p-14 shadow-xl shadow-slate-200/30 border border-slate-200/50 min-h-[600px] relative overflow-hidden"
                            id="star-detail-panel">
                            <div id="star-content" class="relative z-10 transition-all duration-300">
                                <div class="flex justify-between items-start mb-10">
                                    <div>
                                        <span
                                            class="text-indigo-400 text-xs font-black tracking-[0.2em] mb-3 block uppercase"
                                            id="star-group">北斗主星</span>
                                        <h3 class="text-5xl font-bold serif text-indigo-950 mb-3" id="star-name">紫微星
                                        </h3>
                                        <p class="text-slate-400 text-sm tracking-[0.3em] font-bold" id="star-alias">THE
                                            EMPEROR</p>
                                    </div>
                                    <div class="text-8xl opacity-10 select-none grayscale flex items-center justify-center p-4 bg-indigo-50 rounded-full"
                                        id="star-icon">
                                        <i data-lucide="crown" class="w-full h-full"></i>
                                    </div>
                                </div>
                                <div class="grid grid-cols-2 gap-6 mb-10">
                                    <div class="p-6 bg-indigo-50/50 rounded-2xl border border-indigo-100/50 shadow-sm">
                                        <div class="flex items-center gap-2 mb-2">
                                            <i data-lucide="atom" class="w-3 h-3 text-indigo-400"></i>
                                            <span
                                                class="text-[10px] uppercase font-bold text-indigo-400 tracking-widest">五行局</span>
                                        </div>
                                        <p class="text-xl font-black text-indigo-900" id="star-element">土 (陰)</p>
                                    </div>
                                    <div class="p-6 bg-amber-50/50 rounded-2xl border border-amber-100/50 shadow-sm">
                                        <div class="flex items-center gap-2 mb-2">
                                            <i data-lucide="tag" class="w-3 h-3 text-amber-500"></i>
                                            <span
                                                class="text-[10px] uppercase font-bold text-amber-500 tracking-widest">主な象意</span>
                                        </div>
                                        <p class="text-xl font-black text-amber-900" id="star-attribute">尊貴・権威</p>
                                    </div>
                                </div>
                                <div class="space-y-10">
                                    <div>
                                        <h4
                                            class="text-xs font-black text-indigo-400 uppercase tracking-[0.3em] mb-5 flex items-center gap-2">
                                            <i data-lucide="scroll" class="w-4 h-4 text-indigo-400"></i>
                                            本質的性質
                                        </h4>
                                        <p class="text-slate-600 leading-relaxed text-lg" id="star-description">
                                            帝王の象徴であり、命盤の中心。強い自尊心と統率力を持ち、周囲を慈しむ高貴な精神を宿します。
                                        </p>
                                    </div>
                                    <div
                                        class="bg-slate-50 p-8 rounded-3xl border border-slate-100 border-l-8 border-l-indigo-600">
                                        <h4 class="text-xs font-black text-indigo-900 uppercase tracking-[0.3em] mb-4">
                                            現代の解釈とアドバイス</h4>
                                        <p class="text-slate-700 leading-relaxed italic" id="star-modern">
                                            経営層やリーダーとしての資質。プライドが高く孤独を恐れる一面も。
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. History & Methodology -->
        <section id="history-method"
            class="py-24 bg-slate-50 px-4 sm:px-6 lg:px-8 border-t border-slate-200/50 scroll-mt">
            <div class="max-w-7xl mx-auto">
                <div class="grid lg:grid-cols-2 gap-24">

                    <!-- History Timeline -->
                    <div class="reveal">
                        <div
                            class="inline-block px-4 py-1.5 rounded-full bg-indigo-50 text-indigo-600 text-xs font-bold mb-6 tracking-widest uppercase">
                            Tradition</div>
                        <h2 class="text-3xl font-extrabold text-[#1e1b4b] serif mb-12 flex items-center gap-3">
                            <i data-lucide="history" class="text-indigo-600 w-8 h-8"></i>
                            歴史と起源
                        </h2>
                        <div class="relative space-y-16">
                            <!-- Vertical Line -->
                            <div
                                class="absolute left-[13px] top-2 bottom-2 w-0.5 bg-gradient-to-b from-indigo-200 via-indigo-100 to-transparent">
                            </div>

                            <!-- Timeline Item 1 -->
                            <div class="relative pl-12 group">
                                <span
                                    class="absolute left-0 top-1 w-7 h-7 rounded-full bg-white border-4 border-indigo-600 shadow-sm z-10 transition-transform group-hover:scale-125"></span>
                                <div
                                    class="bg-white p-8 rounded-[2rem] border border-slate-200/60 shadow-sm group-hover:shadow-md transition-shadow">
                                    <h4 class="font-bold text-indigo-950 text-xl mb-3">起源：唐末〜宋代</h4>
                                    <p class="text-slate-500 leading-relaxed">
                                        伝説的な道士、<strong
                                            class="text-indigo-600">陳希夷（ちんきい）</strong>によって創始。当時の最先端数理と言語体系を統合。
                                    </p>
                                </div>
                            </div>

                            <!-- Timeline Item 2 -->
                            <div class="relative pl-12 group">
                                <span
                                    class="absolute left-0 top-1 w-7 h-7 rounded-full bg-white border-4 border-indigo-400 shadow-sm z-10 transition-transform group-hover:scale-125"></span>
                                <div
                                    class="bg-white p-8 rounded-[2rem] border border-slate-200/60 shadow-sm group-hover:shadow-md transition-shadow">
                                    <h4 class="font-bold text-indigo-950 text-xl mb-3">発展：明代の秘術</h4>
                                    <p class="text-slate-500 leading-relaxed">
                                        『紫微斗数全書』の編纂。皇帝のみがアクセス可能な「禁域の占術」として、宮廷内で密かに伝承されました。
                                    </p>
                                </div>
                            </div>

                            <!-- Timeline Item 3 -->
                            <div class="relative pl-12 group">
                                <span
                                    class="absolute left-0 top-1 w-7 h-7 rounded-full bg-white border-4 border-indigo-200 shadow-sm z-10 transition-transform group-hover:scale-125"></span>
                                <div
                                    class="bg-white p-8 rounded-[2rem] border border-slate-200/60 shadow-sm group-hover:shadow-md transition-shadow">
                                    <h4 class="font-bold text-indigo-950 text-xl mb-3">現代：論理の完成</h4>
                                    <p class="text-slate-500 leading-relaxed">
                                        現代台湾・香港で飛星派や欽天派が隆盛。心理学的側面も包含した高度な人格分析システムへと進化。
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- How-to Steps -->
                    <div class="reveal">
                        <div
                            class="inline-block px-4 py-1.5 rounded-full bg-indigo-50 text-indigo-600 text-xs font-bold mb-6 tracking-widest uppercase">
                            Methodology</div>
                        <h2 class="text-3xl font-extrabold text-[#1e1b4b] serif mb-12 flex items-center gap-3">
                            <i data-lucide="file-check-2" class="text-indigo-600 w-8 h-8"></i>
                            鑑定のプロセス
                        </h2>
                        <div class="space-y-4">
                            <div
                                class="group p-8 bg-white rounded-[2rem] border border-slate-200/60 shadow-sm hover:shadow-xl hover:border-indigo-100 transition-all duration-500">
                                <div class="flex items-start gap-6">
                                    <div
                                        class="w-12 h-12 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center font-black text-lg shrink-0 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                        01</div>
                                    <div>
                                        <h4 class="text-lg font-bold text-indigo-950 mb-2">正確な出生データの収集</h4>
                                        <p class="text-sm text-slate-500 leading-relaxed">
                                            出生時間は必須です。数分の差が命盤（チャート）の構造を劇的に変えるため、最も精緻なデータを必要とします。</p>
                                    </div>
                                </div>
                            </div>
                            <div
                                class="group p-8 bg-white rounded-[2rem] border border-slate-200/60 shadow-sm hover:shadow-xl hover:border-indigo-100 transition-all duration-500">
                                <div class="flex items-start gap-6">
                                    <div
                                        class="w-12 h-12 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center font-black text-lg shrink-0 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                        02</div>
                                    <div>
                                        <h4 class="text-lg font-bold text-indigo-950 mb-2">太陰太陽暦への演算</h4>
                                        <p class="text-sm text-slate-500 leading-relaxed">
                                            西洋暦を月の満ち欠けに基づいた太陰暦へと変換。自然界のバイオリズムと同期した時間軸を設定します。</p>
                                    </div>
                                </div>
                            </div>
                            <div
                                class="group p-8 bg-white rounded-[2rem] border border-slate-200/60 shadow-sm hover:shadow-xl hover:border-indigo-100 transition-all duration-500">
                                <div class="flex items-start gap-6">
                                    <div
                                        class="w-12 h-12 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center font-black text-lg shrink-0 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                        03</div>
                                    <div>
                                        <h4 class="text-lg font-bold text-indigo-950 mb-2">命盤の幾何学的構築</h4>
                                        <p class="text-sm text-slate-500 leading-relaxed">
                                            12宮を配置し、高度なアルゴリズムで主星・副星を盤上に展開。多次元的な運命のマップを生成します。</p>
                                    </div>
                                </div>
                            </div>
                            <div
                                class="group p-8 bg-white rounded-[2rem] border border-slate-200/60 shadow-sm hover:shadow-xl hover:border-indigo-100 transition-all duration-500">
                                <div class="flex items-start gap-6">
                                    <div
                                        class="w-12 h-12 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center font-black text-lg shrink-0 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                        04</div>
                                    <div>
                                        <h4 class="text-lg font-bold text-indigo-950 mb-2">アルゴリズムによる深層解読</h4>
                                        <p class="text-sm text-slate-500 leading-relaxed">
                                            「三方四正」や「飛星」など、星同士の幾何学的な干渉エネルギーを解析し、具体的な天命を導き出します。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
        <!-- Footer -->
        <footer class="bg-slate-50 py-20 border-t border-slate-200/60">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex flex-col items-center text-center space-y-12">
                    <!-- Brand section -->
                    <div class="space-y-6">
                        <div class="flex justify-center">
                            <div
                                class="w-14 h-14 bg-indigo-900/5 rounded-2xl flex items-center justify-center border border-indigo-900/10 shadow-sm">
                                <i data-lucide="moon-star" class="w-7 h-7 text-indigo-900"></i>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-slate-900 serif tracking-tight">
                                Triscope <span class="text-indigo-700">Zi Wei Dou Shu</span>
                            </h3>
                            <p class="text-[10px] uppercase tracking-[0.3em] font-bold text-slate-400 mt-1">Imperial
                                Astrology × Cosmic Blueprint</p>
                        </div>
                        <p class="text-sm max-w-md mx-auto leading-relaxed text-slate-500 font-medium">
                            星々の配置から読み解く、至高の天命。宇宙のバイオリズムと同調し、あなただけの可能性を照らし出す光の羅針盤。
                        </p>
                    </div>

                    <!-- Horizontal line and Copyright -->
                    <div
                        class="w-full pt-10 border-t border-slate-200/80 flex flex-col md:flex-row justify-between items-center gap-6 text-[10px] uppercase tracking-widest font-bold text-slate-400">
                        <span>© 2026 Triscope Project. All rights reserved.</span>
                        <div class="flex gap-8">
                            <span class="hover:text-indigo-700 transition-colors cursor-default">Celestial Wisdom</span>
                            <span class="hover:text-indigo-700 transition-colors cursor-default">Divine Guidance</span>
                        </div>
                    </div>

                    <!-- Footer Disclaimer Card -->
                    <div class="bg-white/50 px-6 py-4 rounded-xl border border-slate-200/50 max-w-3xl">
                        <p class="text-[10px] text-slate-400 leading-relaxed italic">
                            ※紫微斗数で示される天命は、あなたの潜在能力と可能性を映す鏡です。星々は道標を示しますが、最終的な選択と創造は常にあなた自身の手の中にあります。
                        </p>
                    </div>
                </div>
            </div>
        </footer>
    </main>

    <script>
        // --- Data ---
        const palaces = [
            { id: "life", name: "命宮", yomi: "Mei-kyu", icon: "compass", subtitle: "運命の司令塔・あなたの本質", desc: "ここはあなたの性格、才能、容姿、そして一生の運命の土台となる場所です。ここに入る星が、あなたの「魂の輪郭」を決定づけます。", keywords: ["本質", "才能", "一生の運"] },
            { id: "siblings", name: "兄弟宮", yomi: "Keitei-kyu", icon: "users", subtitle: "親しき人々との響き合わせ", desc: "兄弟姉妹や深い絆で結ばれた親友、同僚との関係を見ます。助け合えるか、あるいは競い合う仲かを暗示します。", keywords: ["兄弟姉妹", "同僚", "親友"] },
            { id: "spouse", name: "夫妻宮", yomi: "Fusai-kyu", icon: "heart", subtitle: "魂の伴侶・愛のカタチ", desc: "好みのタイプや、将来出会う伴侶の性格、結婚後の家庭環境を示します。愛がどのような試練や喜びをもたらすかを説きます。", keywords: ["結婚", "恋愛", "パートナー"] },
            { id: "children", name: "子女宮", yomi: "Shijo-kyu", icon: "sparkles", subtitle: "次世代への継承と創造", desc: "子供との縁、部下や後輩との関係、そしてあなたの性的な魅力や生命力の源泉をも表します。", keywords: ["子供", "後輩", "生命力"] },
            { id: "wealth", name: "財帛宮", yomi: "Zaihaku-kyu", icon: "coins", subtitle: "豊かさの源泉・金銭の流転", desc: "どのように富を築き、どのように使うか。あなたにとって「富」とは何か、その哲学と実利の両面を映し出します。", keywords: ["金運", "稼ぎ方", "財産"] },
            { id: "health", name: "疾厄宮", yomi: "Shitsuyaku-kyu", icon: "activity", subtitle: "肉体の器・浄化のプロセス", desc: "健康状態、かかりやすい病気、身体の弱点。内面に抱えるストレスがどこに現れやすいかを示します。", keywords: ["健康", "体質", "未病"] },
            { id: "travel", name: "遷移宮", yomi: "Sen-i-kyu", icon: "map", subtitle: "外の世界・社会的な仮面", desc: "移動による運気、社会的な顔、初対面の印象。一歩家を出た時のあなたの「輝き」がここにあります。", keywords: ["外出", "第一印象", "移動"] },
            { id: "friends", name: "奴僕宮", yomi: "Nubo-kyu", icon: "handshake", subtitle: "社会との繋がり・支援の輪", desc: "広い交友関係、顧客、ファン、不特定多数の人々との関係。世の中からどのような支持を受けるかを表します。", keywords: ["友人", "支持層", "ファン"] },
            { id: "career", name: "官禄宮", yomi: "Kanroku-kyu", icon: "award", subtitle: "天職と功績・磨かれる魂", desc: "仕事への姿勢、適職、社会的成功への階段。あなたが魂を込めて取り組むべき活動の方向性がここにあります。", keywords: ["仕事", "出世", "適職"] },
            { id: "property", name: "田宅宮", yomi: "Dentaku-kyu", icon: "home", subtitle: "安住の地・蓄えられた実り", desc: "不動産運、住環境、そして先祖から受け継ぐ精神的な資産。心休まる「場所」を見極めるための宮です。", keywords: ["不動産", "住まい", "貯蓄"] },
            { id: "mental", name: "福徳宮", yomi: "Fukutoku-kyu", icon: "sun-dim", subtitle: "精神の平安・内なる幸福", desc: "魂の安定度、趣味、深層心理。何に喜びを感じ、どのように安らぎを得るかという精神のクオリティを司ります。", keywords: ["精神", "寿命", "幸福度"] },
            { id: "parents", name: "父母宮", yomi: "Fubo-kyu", icon: "landmark", subtitle: "ルーツと権威・目上の導き", desc: "両親、上司、目上の人々。あなたのルーツを支える人々からの恩恵や、解決すべき因縁を読み解きます。", keywords: ["両親", "上司", "後ろ盾"] }
        ];

        const stars = [
            { name: "紫微星", yomi: "Shibi-sei", alias: "THE EMPEROR", group: "北斗主星", icon: "crown", element: "土（陰）", attribute: "尊貴・統率", desc: "帝王の象徴。強い自尊心と統率力を持ち、高貴な精神を宿します。周囲からの補佐があってこそ真の力を発揮します。", modern: "経営者、組織のトップ。自分のプライドと責任感で人を動かす適性があります。" },
            { name: "天機星", yomi: "Tenki-sei", alias: "THE STRATEGIST", group: "南斗星", icon: "brain", element: "木（陰）", attribute: "知恵・変化", desc: "参謀の星。非常に頭の回転が速く、知識欲が旺盛です。変化を好み、新しいものを企画する才能に長けます。", modern: "IT・技術職、プランナー、研究職。知的な好奇心を満たす環境で輝きます。" },
            { name: "太陽星", yomi: "Taiyo-sei", alias: "THE SUN", group: "中天星", icon: "sun", element: "火（陽）", attribute: "博愛・光明", desc: "周囲を平等に照らす光。公序良俗に則り、寛大で他人を助けることに喜びを感じます。一方で、見栄を張りやすい面も。", modern: "教育、マスコミ、公益事業。公の場で多くの人の注目を集める仕事に向きます。" },
            { name: "武曲星", yomi: "Bugoku-sei", alias: "THE GENERAL", group: "北斗星", icon: "swords", element: "金（陰）", attribute: "決断・財星", desc: "実行力ある将軍。ドライですが、決断力と実務能力に優れ、確実に成果や財を手にします。寡黙で孤独を好む傾向があります。", modern: "金融、実業、専門技術。実利を重視するシビアな環境で圧倒的な成果を出します。" },
            { name: "天同星", yomi: "Tendo-sei", alias: "THE CHILD", group: "南斗星", icon: "baby", element: "水（陽）", attribute: "温和・享受", desc: "福の神の星。子供のように無邪気で、穏やかな性格。周囲との調和を重んじ、楽しみを見つけるのが得意です。", modern: "サービス業、カウンセリング、芸能。周囲を癒やし、楽しませる役割。" },
            { name: "廉貞星", yomi: "Rentei-sei", alias: "THE DIPLOMAT", group: "北斗星", icon: "flame", element: "火（陰）", attribute: "権威・感性", desc: "「次なる魅力の星」。凛とした強さと情熱を秘めます。仕事には非常に厳格ですが、内面は非常に多感で複雑です。", modern: "行政関係、デザイン、芸能。規律と美的感覚が必要な分野。" },
            { name: "天府星", yomi: "Tenpu-sei", alias: "THE TREASURER", group: "南斗主星", icon: "landmark", element: "土（陽）", attribute: "安定・慈愛", desc: "慈愛満ちた金庫。保守的で安定を好み、豊かな包容力で周囲を包みます。組織を維持・管理する能力が非常に高いです。", modern: "銀行、不動産、総務、経営安定期のリーダー。守備力の高さを活かす場。" },
            { name: "太陰星", yomi: "Taiin-sei", alias: "THE MOON", group: "中天星", icon: "moon", element: "水（陰）", attribute: "ロマン・慈愛", desc: "静寂の月。感受性が豊かで、美を愛するロマンチスト。控えめですが、深い思考と母性的な優しさを持ちます。", modern: "芸術家、デザイナー、不動産、ケア職。繊細な感覚が武器になります。" },
            { name: "貪狼星", yomi: "Donro-sei", alias: "THE WOLF", group: "北斗星", icon: "sparkles", element: "木・水", attribute: "社交・欲望", desc: "欲望と芸の星。飽くなき好奇心と卓越した社交術。人生を遊び尽くすエネルギーに満ち、多芸多才です。", modern: "営業、フリーランス、実業。人を惹きつけるカリスマ性を発揮します。" },
            { name: "巨門星", yomi: "Komon-sei", alias: "THE ORATOR", group: "北斗星", icon: "message-square", element: "水（陰）", attribute: "口才・分析", desc: "口の星。優れた弁説と鋭い分析力。物事の裏側を見抜く力がありますが、言葉によるトラブルには注意が必要です。", modern: "法律家、教師、評論家、アナウンサー、研究者。正確な言語化が求められる仕事。" },
            { name: "天相星", yomi: "Tenso-sei", alias: "THE MINISTER", group: "南斗星", icon: "shield", element: "水（陽）", attribute: "補佐・慈愛", desc: "誠実なパートナー。人を助けることで自分が輝く「補佐の星」。身なりを整え、調和ある環境を作ります。", modern: "秘書、公務員、ホスピタリティ産業。優れた調整役として必要とされます。" },
            { name: "天梁星", yomi: "Tenryo-sei", alias: "THE SAGE", group: "南斗星", icon: "sparkles", element: "土（陽）", attribute: "指導・慈愛", desc: "賢者の星。落ち着きがあり、面倒見の良い親分肌。困難を乗り越える守護の力を持ち、指導者的な立場に置かれます。", modern: "医療、教育、コンサルタント、監査。徳を持って人を導く役割。" },
            { name: "七殺星", yomi: "Shichisatsu-sei", alias: "THE WARRIOR", group: "南斗星", icon: "sword", element: "金・火", attribute: "権威・独行", desc: "孤独な勇者。ずば抜けた行動力と独立心を持ちます。変化を恐れず、荒波の中に活路を見出します。", modern: "ベンチャー起業家、アスリート、外科医。個人の力で勝負する世界。" },
            { name: "破軍星", yomi: "Hagun-sei", alias: "THE REBEL", group: "北斗星", icon: "waves", element: "水（陰）", attribute: "耗散・開拓", desc: "破壊と創造。既存の概念を壊し、ゼロから新しいものを作り出す猛烈なエネルギーです。人生の変動が激しくなります。", modern: "新技術開発、開拓者、イノベーター。誰も通っていない道を切り拓く場。" }
        ];

        const branches = ["子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"];

        // --- Core Functions ---

        document.addEventListener('DOMContentLoaded', () => {
            initInputs();
            initCapabilityChart();
            renderPalaces();
            renderStarNav();
            setupIntersectionObserver();

            // Defaults
            selectPalace(0);
            selectStar(0);

            // Init Static Icons
            lucide.createIcons();
        });

        function initInputs() {
            const ySelect = document.getElementById('birth-year');
            const mSelect = document.getElementById('birth-month');
            const dSelect = document.getElementById('birth-day');

            const currentYear = new Date().getFullYear();
            for (let i = currentYear; i >= 1900; i--) {
                ySelect.add(new Option(`${i}年`, i));
            }
            for (let i = 1; i <= 12; i++) {
                mSelect.add(new Option(`${i}月`, i));
            }
            for (let i = 1; i <= 31; i++) {
                dSelect.add(new Option(`${i}日`, i));
            }
            ySelect.value = 1990;
        }

        function setupForm() {
            // Initialization
        }

        function diagnose() {
            const ySelect = document.getElementById('birth-year');
            const mSelect = document.getElementById('birth-month');
            const dSelect = document.getElementById('birth-day');

            const year = parseInt(ySelect.value);
            const month = parseInt(mSelect.value);
            const day = parseInt(dSelect.value);
            const hourIndex = parseInt(document.getElementById('birth-hour').value);

            const resultArea = document.getElementById('diagnosis-result');
            resultArea.classList.remove('hidden');
            resultArea.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // --- ZWDS Simplified Logic ---
            const startPos = 2; // Yin (寅)
            let lifePalacePos = (startPos + (month - 1) - (hourIndex - 1) + 12) % 12;
            const lifePalaceName = branches[lifePalacePos];

            const elementTypes = ["水二局", "木三局", "金四局", "土五局", "火六局"];
            const elementBase = (year + lifePalacePos + day) % 5;
            const constElementName = elementTypes[elementBase];
            const elementNum = [2, 3, 4, 5, 6][elementBase];

            const starIndex = (day + lifePalacePos + elementNum) % stars.length;
            const star = stars[starIndex];

            // --- UI Update ---
            const resName = document.getElementById('res-star-name');
            const resBrief = document.getElementById('res-brief');

            resName.style.opacity = '0';
            resBrief.style.opacity = '0';

            setTimeout(() => {
                resName.textContent = star.name;
                resBrief.innerHTML = `
                    <p class="mb-4">あなたは<strong>「${star.name}」</strong>の加護を色濃く受けて生まれてきました。${star.desc.split('。')[0]}。</p>
                    <p class="text-sm font-bold text-indigo-700 italic border-l-2 border-indigo-200 pl-4">アドバイス: ${star.modern}</p>
                `;
                document.getElementById('res-main-palace').textContent = `命宮 (${lifePalaceName})`;
                document.getElementById('res-element').textContent = constElementName;

                resName.style.opacity = '1';
                resBrief.style.opacity = '1';
                lucide.createIcons();
            }, 100);

            const steps = document.getElementById('calculation-steps');
            steps.innerHTML = `
                <div class="flex items-start gap-3">
                    <span class="text-indigo-600 font-black">STEP 1</span>
                    <div>【命宮の確定】 寅宮から生月(${month})分進み、そこから出生時間(${branches[hourIndex - 1]})分戻る → <span class='text-indigo-900 font-bold'>${lifePalaceName}宮</span></div>
                </div>
                <div class="flex items-start gap-3 border-t border-indigo-100/30 pt-3">
                    <span class="text-indigo-600 font-black">STEP 2</span>
                    <div>【五局の判定】 生年(${year})と命宮・誕生日の動的相互作用から数理導出 → <span class='text-indigo-900 font-bold'>${constElementName}</span></div>
                </div>
                <div class="flex items-start gap-3 border-t border-indigo-100/30 pt-3">
                    <span class="text-indigo-600 font-black">STEP 4</span>
                    <div>【主星の配置】 五局(${elementNum})と誕生日(${day}日)による位置エネルギー計算 → <span class='text-indigo-900 font-bold'>${star.name}</span></div>
                </div>
            `;
        }

        function initCapabilityChart() {
            const ctx = document.getElementById('capabilityChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['深層心理', '人生の時期', '才能・適性', '対人関係', 'YES/NO', '毎日の運勢'],
                    datasets: [{
                        label: '紫微斗数',
                        data: [95, 98, 92, 90, 40, 50],
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        borderColor: '#4f46e5',
                        pointBackgroundColor: '#4f46e5',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            ticks: { display: false, max: 100 },
                            pointLabels: { color: '#6B7280', font: { size: 10 } }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function renderPalaces() {
            const grid = document.getElementById('palace-grid');
            palaces.forEach((p, i) => {
                const card = document.createElement('div');
                card.className = `palace-card bg-white p-4 rounded-xl text-center flex flex-col items-center justify-center h-28 group palace-item-${i}`;
                card.innerHTML = `
                    <div class="mb-2 p-3 bg-indigo-50 rounded-lg text-indigo-600 transition-colors group-hover:bg-indigo-600 group-hover:text-white group-[.active]:bg-indigo-600 group-[.active]:text-white">
                        <i data-lucide="${p.icon}" class="w-6 h-6 stroke-[1.5]"></i>
                    </div>
                    <span class="text-[11px] font-bold text-slate-700 transition-colors group-hover:text-indigo-900 group-[.active]:text-indigo-900">${p.name}</span>
                `;
                card.onclick = () => selectPalace(i, card);
                grid.appendChild(card);
            });
            lucide.createIcons();
        }

        function selectPalace(index, el) {
            document.querySelectorAll('.palace-card').forEach(c => c.classList.remove('active'));
            if (el) el.classList.add('active');
            else {
                const first = document.querySelector('.palace-item-0');
                if (first) first.classList.add('active');
            }

            const p = palaces[index];
            const detail = document.getElementById('palace-detail');
            detail.style.opacity = '0';

            setTimeout(() => {
                document.getElementById('detail-icon').innerHTML = `<i data-lucide="${p.icon}" class="w-10 h-10 stroke-[1.5] text-indigo-600"></i>`;
                document.getElementById('detail-name').textContent = p.name;
                document.getElementById('detail-yomi').textContent = p.yomi;
                document.getElementById('detail-subtitle').textContent = p.subtitle;
                document.getElementById('detail-desc').textContent = p.desc;

                const kw = document.getElementById('detail-keywords');
                kw.innerHTML = '';
                p.keywords.forEach(k => {
                    const s = document.createElement('span');
                    s.className = 'px-3 py-1 bg-indigo-50 text-indigo-600 rounded-full text-[10px] uppercase font-bold tracking-wider';
                    s.textContent = k;
                    kw.appendChild(s);
                });
                lucide.createIcons();
                detail.style.opacity = '1';
            }, 200);
        }

        function renderStarNav() {
            const nav = document.getElementById('star-nav-list');
            stars.forEach((s, i) => {
                const btn = document.createElement('button');
                btn.className = `star-link text-left py-2 w-full text-sm block star-btn-${i}`;
                btn.textContent = `${s.name} (${s.alias})`;
                btn.onclick = () => selectStar(i, btn);
                nav.appendChild(btn);
            });
        }

        function selectStar(index, el) {
            document.querySelectorAll('.star-link').forEach(l => l.classList.remove('active'));
            if (el) el.classList.add('active');
            else {
                const first = document.querySelector('.star-btn-0');
                if (first) first.classList.add('active');
            }

            const s = stars[index];
            const content = document.getElementById('star-content');
            content.style.opacity = '0';

            setTimeout(() => {
                document.getElementById('star-group').textContent = s.group;
                document.getElementById('star-name').textContent = s.name;
                document.getElementById('star-alias').textContent = s.alias;
                document.getElementById('star-icon').innerHTML = `<i data-lucide="${s.icon}" class="w-16 h-16"></i>`;
                lucide.createIcons();
                document.getElementById('star-element').textContent = s.element;
                document.getElementById('star-attribute').textContent = s.attribute;
                document.getElementById('star-description').textContent = s.desc;
                document.getElementById('star-modern').textContent = s.modern;
                content.style.opacity = '1';
            }, 200);
        }

        function setupIntersectionObserver() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('active');
                });
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
        }

        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            // Close menu on link click
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });
        }

    </script>
</body>

</html>