<!-- Chosen Palette: Zen Parchment (Warm Neutrals & Ink) - Background: #fafaf9 (Stone-50), Text: #1c1917 (Stone-900), Accents: #b91c1c (Red-700 for stamps/vitality), #d97706 (Amber-600 for gold/wisdom). Designed to evoke the feeling of ancient washi paper and calligraphy. -->

<!-- Application Structure Plan: The app is designed as a "Digital Scroll" experience. 
    1. 'Hero Section': Introduces the concept of 'Change' (Yi) with an interactive Yin-Yang animation to immediately engage the user.
    2. 'The Essence (概要 & 特性)': Uses a comparison card layout to distinguish 'Bokujutsu' (I Ching) from 'Meijutsu' (Astrology) and 'Sojutsu' (Face reading), clarifying its unique position.
    3. 'The Logic of Synchronicty (根拠)': A visualization section using Chart.js to explain the probability and the theory of meaningful coincidence vs. random chance.
    4. 'Capabilities (得意分野)': An interactive "Can/Cannot" toggle section. Users click cards to flip them or see details, clarifying misconceptions about what I Ching can predict.
    5. 'Interactive Ritual (実践 & 歴史)': The core interactive feature. A "Virtual Coin Toss" simulation that teaches the user the method (step-by-step) while simultaneously building a Hexagram. This combines the 'History' (context) with 'Method' (action) for active learning.
    6. 'Deep Dive (64 Hexagrams)': A grid visualization of the 64 combinations, allowing users to hover and see the structure, reinforcing the complexity behind the binary logic.
    This structure moves from Abstract -> Comparative -> Practical -> Experiential, ensuring the user understands the *why* before the *how*.
-->

<!-- Visualization & Content Choices:
    1. Yin/Yang Balance (Chart.js Doughnut): To visualize the dynamic balance within a specific Hexagram. Goal: Inform/Analyze.
    2. Divination Comparison (Interactive Cards): HTML/Tailwind Grid. Goal: Compare. Text-based comparison is best here for clarity.
    3. Virtual Coin Toss (Custom JS + DOM Manipulation): To simulate the 'Three Coin Method'. Goal: Change/Engage. Replaces static text instructions with an active process.
    4. Hexagram Structure (CSS/HTML Blocks): Representing the lines (Yao) visually using CSS heights and borders. NO SVG.
    5. The 64 Hexagram Grid (HTML Grid + JS Tooltips): Shows the scale of the system. Goal: Organize.
    CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. All icons are Unicode or CSS shapes.
-->

<!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>易経 (I Ching): 変化の書 | Triscope</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <!-- 共通CSS -->
    <link rel="stylesheet" href="../../assets/common.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* bodyスタイルは common.css で定義 */


        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            height: 300px;
            margin: 0 auto;
        }

        .hex-line {
            width: 100%;
            height: 12px;
            margin-bottom: 8px;
            border-radius: 2px;
            transition: all 0.5s ease;
        }

        .hex-line.yang {
            background-color: #1c1917;
        }

        .hex-line.yin {
            display: flex;
            justify-content: space-between;
            background-color: transparent !important;
        }

        .hex-line-segment {
            width: 42%;
            height: 100%;
            background-color: #1c1917;
            border-radius: 2px;
        }

        .hex-line.old-yang {
            background-color: #444;
            /* Changing Yang */
            position: relative;
        }

        .hex-line.old-yang::after {
            content: '○';
            /* Change marker */
            position: absolute;
            right: -25px;
            top: -5px;
            font-size: 12px;
            color: #b91c1c;
        }

        .hex-line.old-yin {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .hex-line.old-yin::before,
        .hex-line.old-yin::after {
            content: '';
            width: 42%;
            height: 100%;
            background-color: #444;
            /* Changing Yin */
            border-radius: 2px;
        }

        .hex-line.old-yin .marker {
            position: absolute;
            right: -25px;
            top: -5px;
            font-size: 12px;
            color: #b91c1c;
        }

        /* Coin Animation Styles */
        .coin-container {
            perspective: 1000px;
        }

        .coin {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #d97706;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-family: serif;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.6s;
            transform-style: preserve-3d;
            position: relative;
        }

        .coin.flip {
            transform: rotateY(720deg) rotateX(360deg);
        }

        .nav-btn.active {
            border-bottom: 2px solid #b91c1c;
            color: #b91c1c;
        }

        /* Fade in animation */
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Custom scrollbar for webkit */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #fafaf9;
        }

        ::-webkit-scrollbar-thumb {
            background: #d6d3d1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a29e;
        }
    </style>
</head>

<body class="flex flex-col min-h-screen">


    <!-- Top Navigation Menu -->
    <nav class="fixed top-0 left-0 w-full z-50 glass-panel border-b border-stone-200">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center cursor-pointer" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
                <div class="w-8 h-8 bg-red-700/10 rounded-lg flex items-center justify-center mr-3">
                    <i data-lucide="circle-dashed" class="w-5 h-5 text-red-700"></i>
                </div>
                <span class="text-2xl font-bold text-stone-900 serif tracking-tight">易占い</span>
                <span class="ml-2 text-xs text-stone-500 uppercase tracking-widest hidden sm:block">I-Ching</span>
            </div>

            <!-- Desktop Nav -->
            <div class="hidden md:flex items-center gap-1">
                <button onclick="scrollToSection('overview')"
                    class="px-4 py-2 rounded-full text-sm font-medium text-stone-600 hover:bg-stone-50 hover:text-stone-900 transition-all flex items-center gap-2">
                    <i data-lucide="info" class="w-4 h-4"></i> 概要・特性
                </button>
                <button onclick="scrollToSection('logic')"
                    class="px-4 py-2 rounded-full text-sm font-medium text-stone-600 hover:bg-stone-50 hover:text-stone-900 transition-all flex items-center gap-2">
                    <i data-lucide="book" class="w-4 h-4"></i> 理論
                </button>
                <button onclick="scrollToSection('history')"
                    class="px-4 py-2 rounded-full text-sm font-medium text-stone-600 hover:bg-stone-50 hover:text-stone-900 transition-all flex items-center gap-2">
                    <i data-lucide="history" class="w-4 h-4"></i> 歴史
                </button>
                <button onclick="scrollToSection('capabilities')"
                    class="px-4 py-2 rounded-full text-sm font-medium text-stone-600 hover:bg-stone-50 hover:text-stone-900 transition-all flex items-center gap-2">
                    <i data-lucide="list-checks" class="w-4 h-4"></i> 得意分野
                </button>
                <button onclick="scrollToSection('gallery')"
                    class="px-4 py-2 rounded-full text-sm font-medium text-stone-600 hover:bg-stone-50 hover:text-stone-900 transition-all flex items-center gap-2">
                    <i data-lucide="grid" class="w-4 h-4"></i> 六十四卦
                </button>
                <button onclick="scrollToSection('simulation')"
                    class="px-4 py-2 rounded-full text-sm font-medium text-white bg-red-700 hover:bg-red-800 transition-all flex items-center gap-2">
                    <i data-lucide="sparkles" class="w-4 h-4"></i> 体験
                </button>
            </div>

            <!-- Mobile Menu Btn -->
            <button id="mobile-menu-btn" class="md:hidden p-2 text-stone-900 hover:bg-gray-100 rounded-lg">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu"
            class="hidden md:hidden bg-white/95 backdrop-blur-md border-t border-stone-100 animate-fade-in">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="scrollToSection('overview'); toggleMobileMenu()"
                    class="block w-full text-left px-3 py-2 text-stone-600 hover:bg-stone-50 rounded-md">概要・特性</button>
                <button onclick="scrollToSection('logic'); toggleMobileMenu()"
                    class="block w-full text-left px-3 py-2 text-stone-600 hover:bg-stone-50 rounded-md">理論と仕組み</button>
                <button onclick="scrollToSection('history'); toggleMobileMenu()"
                    class="block w-full text-left px-3 py-2 text-stone-600 hover:bg-stone-50 rounded-md">歴史的変遷</button>
                <button onclick="scrollToSection('capabilities'); toggleMobileMenu()"
                    class="block w-full text-left px-3 py-2 text-stone-600 hover:bg-stone-50 rounded-md">得意分野</button>
                <button onclick="scrollToSection('gallery'); toggleMobileMenu()"
                    class="block w-full text-left px-3 py-2 text-stone-600 hover:bg-stone-50 rounded-md">六十四卦</button>
                <button onclick="scrollToSection('simulation'); toggleMobileMenu()"
                    class="block w-full text-left px-3 py-2 text-red-700 border border-red-100 rounded-md text-center">実践シミュレーション</button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow">

        <!-- Hero Section -->
        <section id="hero" class="relative py-24 px-4 sm:px-6 lg:px-8 text-center bg-stone-100 overflow-hidden">
            <div class="max-w-4xl mx-auto z-10 relative fade-in">
                <h2 class="text-4xl md:text-6xl font-bold text-stone-800 mb-6 serif tracking-tight">変化を読み解く、<br>東洋最古の叡智
                </h2>
                <p class="text-lg text-stone-600 mb-10 leading-relaxed max-w-2xl mx-auto font-light">
                    「易（えき）」は単なる占いではありません。<br>それは宇宙の法則、陰と陽のバランス、そして「変化」そのものを体系化した哲学です。<br>
                    このレポートでは、易のメカニズムをインタラクティブに解き明かします。
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button onclick="scrollToSection('overview')"
                        class="bg-stone-800 text-white px-8 py-3 rounded-full hover:bg-stone-700 transition shadow-lg text-sm tracking-widest uppercase">レポートを読む</button>
                    <button onclick="scrollToSection('simulation')"
                        class="bg-red-700 text-white px-8 py-3 rounded-full hover:bg-red-800 transition shadow-lg text-sm tracking-widest uppercase flex items-center justify-center gap-2">
                        <span>易を体験する</span>
                        <i data-lucide="arrow-right" class="w-4 h-4"></i>
                    </button>
                </div>
            </div>
            <!-- Decorative background element: Giant Kanji for Change -->
            <div
                class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-[300px] md:text-[500px] text-stone-200 opacity-20 pointer-events-none select-none serif font-bold z-0">
                易</div>
        </section>

        <!-- 1. Overview & Characteristics -->
        <section id="overview" class="py-20 px-4 sm:px-6 lg:px-8 max-w-6xl mx-auto">
            <div class="mb-12 text-center">
                <span class="text-red-700 font-bold tracking-widest uppercase text-xs border-b border-red-700 pb-1">01.
                    Overview</span>
                <h3 class="text-3xl font-bold text-stone-800 mt-4 serif">易（えき）とは何か？</h3>
                <p class="mt-4 text-stone-600 max-w-2xl mx-auto leading-relaxed">
                    占術は大きく「命・卜・相（めい・ぼく・そう）」の3つに分類されます。易はその中で<strong>「卜術（ぼくじゅつ）」</strong>の最高峰とされています。<br>
                    偶然性の中に必然を見出す、シンクロニシティ（共時性）の芸術です。
                </p>
            </div>

            <!-- The Three Meanings (New Philosophy Section) -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-16">
                <div class="bg-stone-800 text-stone-200 p-6 rounded-lg text-center border border-stone-700">
                    <h5 class="text-amber-500 font-bold mb-2 serif">変易 (Hen'eki)</h5>
                    <p class="text-[11px] leading-relaxed">
                        宇宙のあらゆるものは、常に変化し続けているという真理。現状に執着せず、変化の波を捉える重要性を説きます。
                    </p>
                </div>
                <div class="bg-stone-800 text-stone-200 p-6 rounded-lg text-center border border-stone-700">
                    <h5 class="text-amber-500 font-bold mb-2 serif">不易 (Fueki)</h5>
                    <p class="text-[11px] leading-relaxed">
                        万物は変化するが、その変化を支配する「法則」だけは永遠に変わらないということ。易はその不変のルールを読み解きます。
                    </p>
                </div>
                <div class="bg-stone-800 text-stone-200 p-6 rounded-lg text-center border border-stone-700">
                    <h5 class="text-amber-500 font-bold mb-2 serif">簡易 (Kan'i)</h5>
                    <p class="text-[11px] leading-relaxed">
                        一見複雑に見える宇宙の現象も、突き詰めれば「陰」と「陽」という非常にシンプルな原理から成り立っているという考えです。
                    </p>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
                <!-- Card 1: Bokujutsu (Highlight) -->
                <div
                    class="bg-white p-8 rounded-xl shadow-lg border-t-4 border-red-700 hover:shadow-2xl transition-all transform hover:-translate-y-1 group">
                    <div
                        class="text-5xl mb-6 text-center group-hover:scale-110 transition-transform duration-300 text-red-700 flex justify-center">
                        <i data-lucide="dice-5" class="w-12 h-12"></i>
                    </div>
                    <h4 class="text-2xl font-bold text-center mb-2 serif text-stone-800">卜術 (Bokujutsu)</h4>
                    <p class="text-center text-xs text-red-600 font-bold mb-4 tracking-widest uppercase">易・タロット・ルーン</p>
                    <p class="text-stone-600 text-sm leading-7">
                        <strong>「偶然」</strong>を媒体として、今この瞬間の運気や、近い未来の成り行きを占います。
                        生年月日が不要で、状況が刻一刻と変わる問題や、二者択一の決断に無類の強さを発揮します。
                    </p>
                </div>

                <!-- Card 2: Meijutsu -->
                <div
                    class="bg-[#f5f5f4] p-8 rounded-xl shadow-sm hover:bg-white hover:shadow-md transition-all duration-300">
                    <div class="text-5xl mb-6 text-center opacity-70 text-stone-500 flex justify-center">
                        <i data-lucide="calendar" class="w-12 h-12"></i>
                    </div>
                    <h4 class="text-xl font-bold text-center mb-2 serif text-stone-700">命術 (Meijutsu)</h4>
                    <p class="text-center text-xs text-stone-500 mb-4 tracking-widest uppercase">四柱推命・西洋占星術</p>
                    <p class="text-stone-500 text-sm leading-7">
                        <strong>「生年月日」</strong>などの不変のデータを用います。
                        生まれ持った性格や才能、長期的な運勢のバイオリズムを見るのに適していますが、「今の相手の気持ち」などは苦手です。
                    </p>
                </div>

                <!-- Card 3: Sojutsu -->
                <div
                    class="bg-[#f5f5f4] p-8 rounded-xl shadow-sm hover:bg-white hover:shadow-md transition-all duration-300">
                    <div class="text-5xl mb-6 text-center opacity-70 text-stone-500 flex justify-center">
                        <i data-lucide="eye" class="w-12 h-12"></i>
                    </div>
                    <h4 class="text-xl font-bold text-center mb-2 serif text-stone-700">相術 (Sojutsu)</h4>
                    <p class="text-center text-xs text-stone-500 mb-4 tracking-widest uppercase">手相・人相・風水</p>
                    <p class="text-stone-500 text-sm leading-7">
                        <strong>「目に見える形」</strong>から現状や影響を読み解きます。
                        環境を変えたり（風水）、行動を変えることで運命を切り開く開運法として活用されます。
                    </p>
                </div>
            </div>
        </section>

        <!-- 2. Theory & Mechanism -->
        <section id="logic" class="py-20 bg-white border-y border-stone-200 scroll-mt-16">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">

                    <!-- Content Column -->
                    <div class="order-2 lg:order-1">
                        <span
                            class="text-amber-600 font-bold tracking-widest uppercase text-xs border-b border-amber-600 pb-1">02.
                            Theory</span>
                        <h3 class="text-3xl font-bold text-stone-800 mt-4 mb-8 serif">易の理論的支柱</h3>

                        <div class="space-y-8">
                            <div class="flex">
                                <div class="flex-shrink-0 mr-4">
                                    <div
                                        class="w-10 h-10 bg-stone-100 rounded-full flex items-center justify-center text-lg font-bold text-stone-700">
                                        1</div>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg text-stone-800">二進法の原点 (Binary Logic)</h4>
                                    <p class="text-stone-600 mt-2 text-sm leading-relaxed">
                                        易は「陰」と「陽」の2つの符号の組み合わせで森羅万象を表します。これは現代のデジタル世界（0と1）の二進法と同じ原理であり、ライプニッツがコンピュータの概念を形作る際にも触発された究極の数理哲学です。
                                    </p>
                                </div>
                            </div>
                            <div class="flex">
                                <div class="flex-shrink-0 mr-4">
                                    <div
                                        class="w-10 h-10 bg-stone-100 rounded-full flex items-center justify-center text-lg font-bold text-stone-700">
                                        2</div>
                                </div>
                                <div>
                                    <h4 class="font-bold text-lg text-stone-800">シンクロニシティ (Synchronicity)</h4>
                                    <p class="text-stone-600 mt-2 text-sm leading-relaxed">
                                        心理学者ユングは、易の的中率を「意味のある偶然の一致」と定義しました。投げられたコインの結果は無作為ではなく、その瞬間のあなたの無意識や宇宙の状態が、一つの「象（かたち）」として結晶化したものです。
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Interpretation Guide -->
                        <div class="mt-12 bg-amber-50 p-6 rounded-xl border border-amber-100">
                            <h4 class="text-sm font-bold text-amber-900 mb-3 flex items-center gap-2">
                                <i data-lucide="layers" class="w-4 h-4"></i> <span>卦の重層的解読</span>
                            </h4>
                            <div class="grid grid-cols-2 gap-6 text-left">
                                <div>
                                    <p class="font-bold text-stone-800 text-xs">互体 (Gotai)</p>
                                    <p class="text-[10px] text-stone-500 mt-1">卦の中に隠された「内側の卦」。表面には見えない潜在的な動きを示します。</p>
                                </div>
                                <div>
                                    <p class="font-bold text-stone-800 text-xs">裏卦 (Rika)</p>
                                    <p class="text-[10px] text-stone-500 mt-1">陰陽をすべて反転させた卦。状況の「真逆の可能性」や影の側面を照らします。</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chart Column: Yin Yang Distribution -->
                    <div
                        class="order-1 lg:order-2 bg-[#fafaf9] p-8 rounded-2xl shadow-inner border border-stone-100 text-center relative overflow-hidden">
                        <!-- Subtle background text -->
                        <div
                            class="absolute -top-10 -right-10 text-[100px] text-stone-200 opacity-20 pointer-events-none serif select-none">
                            ☯</div>

                        <h4 class="text-lg font-bold mb-2 serif text-stone-800">数理的バランスの視覚化</h4>
                        <p class="text-xs text-stone-500 mb-8">森羅万象は常に「不均衡」から「均衡」へと向かう動的なプロセスにあります。</p>

                        <div class="chart-container">
                            <canvas id="yinYangChart"></canvas>
                        </div>

                        <div class="mt-8 pt-6 border-t border-stone-200 flex justify-center gap-3">
                            <button onclick="updateChartData('yang')"
                                class="text-[10px] font-bold bg-stone-800 text-white px-3 py-1.5 rounded hover:bg-stone-700 transition">陽優勢</button>
                            <button onclick="updateChartData('balanced')"
                                class="text-[10px] font-bold bg-white border border-stone-300 px-3 py-1.5 rounded hover:bg-stone-50 transition">調和</button>
                            <button onclick="updateChartData('yin')"
                                class="text-[10px] font-bold bg-white border border-stone-300 px-3 py-1.5 rounded hover:bg-stone-50 transition">陰優勢</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. Historical Transition (NEW Comprehensive Section) -->
        <section id="history" class="py-24 bg-stone-50 border-b border-stone-200 scroll-mt-16 overflow-hidden">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <span
                        class="text-red-700 font-bold tracking-widest uppercase text-xs border-b border-red-700 pb-1">03.
                        History</span>
                    <h3 class="text-4xl font-bold text-stone-800 mt-4 serif">歴史的変遷</h3>
                    <p class="mt-4 text-stone-600 max-w-3xl mx-auto leading-relaxed text-sm">
                        ～大陸の叡智から日本の処世術へ～<br>
                        易の歴史は、シャーマニズムの神託から始まり、帝王学を経て、個人の内面を探求する哲学へと深化してきた壮大な旅路です。
                    </p>
                </div>

                <div class="relative">
                    <!-- Vertical Timeline Line -->
                    <div class="hidden lg:block absolute left-1/2 top-0 bottom-0 w-px bg-stone-200 -translate-x-1/2">
                    </div>

                    <!-- Period 1: China -->
                    <div class="mb-20 relative lg:flex lg:justify-between items-center group">
                        <div class="lg:w-[45%] lg:text-right mb-8 lg:mb-0">
                            <h4 class="text-2xl font-bold text-stone-900 serif mb-4">成立と儒教化：神託から倫理へ</h4>
                            <p class="text-sm text-stone-600 leading-relaxed">
                                伝説によれば太古の聖王・伏羲が八卦を作り、周の文王と周公旦が言葉を添え、孔子が哲学的体系を完成させたとされます。当初は実用的な「卜筮の書」でしたが、儒教の国教化を経て、宇宙の原理と人間の道徳を結びつける<strong>「帝王学の教科書」</strong>としての地位を確立しました。
                            </p>
                        </div>
                        <div
                            class="hidden lg:flex absolute left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-stone-800 border-4 border-white z-10">
                        </div>
                        <div class="lg:w-[45%] bg-white p-6 rounded-xl border border-stone-100 shadow-sm">
                            <span
                                class="text-[10px] font-bold text-red-700 uppercase tracking-widest block mb-2">Ancient
                                China</span>
                            <ul class="text-xs text-stone-500 space-y-2">
                                <li class="flex items-start gap-2"><i data-lucide="check" class="w-3 h-3 mt-0.5"></i>
                                    殷代：亀甲占いからのルーツ</li>
                                <li class="flex items-start gap-2"><i data-lucide="check" class="w-3 h-3 mt-0.5"></i>
                                    周代：筮竹を用いた数理的体系化</li>
                                <li class="flex items-start gap-2"><i data-lucide="check" class="w-3 h-3 mt-0.5"></i>
                                    漢代以降：形而上学の書へ昇華</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Period 2: Edo Japan -->
                    <div class="mb-20 relative lg:flex lg:flex-row-reverse lg:justify-between items-center">
                        <div class="lg:w-[45%] lg:text-left mb-8 lg:mb-0">
                            <h4 class="text-2xl font-bold text-stone-900 serif mb-4">江戸時代：易の黄金期</h4>
                            <p class="text-sm text-stone-600 leading-relaxed mb-4">
                                文治政治への移行に伴い、易は武士階級の必須教養となりました。京都を中心に伊藤仁斎、荻生徂徠らが独自の学説を展開し、地域社会へ爆発的に浸透しました。
                            </p>
                            <!-- Featured Figure card -->
                            <div class="bg-amber-50 p-5 rounded-lg border border-amber-100">
                                <h5 class="font-bold text-stone-800 text-sm mb-2 flex items-center gap-2">
                                    <i data-lucide="sparkles" class="w-4 h-4 text-amber-600"></i>
                                    異端の天才・真勢中州 (1754-1805)
                                </h5>
                                <p class="text-xs text-stone-600 leading-relaxed">
                                    注釈に囚われず、卦の「形」を緻密に読み解く「真勢流」を確立。「互体」に潜む象徴を見出す彼の技法は、現代の易学にも多大な影響を与えています。
                                </p>
                            </div>
                        </div>
                        <div
                            class="hidden lg:flex absolute left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-red-700 border-4 border-white z-10">
                        </div>
                        <div class="lg:w-[45%] bg-white p-6 rounded-xl border border-stone-100 shadow-sm">
                            <span class="text-[10px] font-bold text-red-700 uppercase tracking-widest block mb-2">Edo
                                Period (Japan)</span>
                            <ul class="text-xs text-stone-500 space-y-3">
                                <li><strong class="text-stone-700">古義学 (伊藤仁斎):</strong> 道徳的実践としての易</li>
                                <li><strong class="text-stone-700">古文辞学 (荻生徂徠):</strong> 政治・経世済民の書</li>
                                <li><strong class="text-stone-700">真勢流:</strong> 象（かたち）の究極的解読</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Period 3: Meiji Modern -->
                    <div class="relative lg:flex lg:justify-between items-center">
                        <div class="lg:w-[45%] lg:text-right mb-8 lg:mb-0">
                            <h4 class="text-2xl font-bold text-stone-900 serif mb-4">明治の「易聖」：近代への羅針盤</h4>
                            <p class="text-sm text-stone-600 leading-relaxed mb-4">
                                明治維新の激動期、易は国家の行く末を占う「実践知」として機能しました。
                            </p>
                            <!-- Figure Cards Grid -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div class="bg-stone-800 p-4 rounded-lg text-left">
                                    <h5 class="text-xs font-bold text-amber-500 truncate mb-1">高島嘉右衛門 (呑象)</h5>
                                    <p class="text-[10px] text-stone-400 leading-tight">
                                        横浜の父。国家重大事に易断を下し、伊藤博文らの信頼を得た「明治の易聖」。</p>
                                </div>
                                <div class="bg-stone-800 p-4 rounded-lg text-left">
                                    <h5 class="text-xs font-bold text-stone-200 truncate mb-1">根本通明</h5>
                                    <p class="text-[10px] text-stone-400 leading-tight">
                                        最後の儒者。清国公使・何如璋との筆談論戦で「天下の大儒」と称賛された権威。</p>
                                </div>
                            </div>
                        </div>
                        <div
                            class="hidden lg:flex absolute left-1/2 -translate-x-1/2 w-4 h-4 rounded-full bg-stone-800 border-4 border-white z-10">
                        </div>
                        <div class="lg:w-[45%] bg-white p-6 rounded-xl border border-stone-100 shadow-sm">
                            <span class="text-[10px] font-bold text-red-700 uppercase tracking-widest block mb-2">Modern
                                Era</span>
                            <p class="text-xs text-stone-500 italic leading-relaxed">
                                「至誠（しせい）」—私利欲を排した極限の集中のみが、変化の真実に辿り着く。近代産業と古典知が交差した、易の最終完成形の一つです。
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. The Eight Trigrams -->
        <section id="bagua" class="py-24 bg-stone-100 scroll-mt-16">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <span
                        class="text-red-700 font-bold tracking-widest uppercase text-xs border-b border-red-700 pb-1">04.
                        The Eight Trigrams</span>
                    <h3 class="text-3xl font-bold text-stone-800 mt-4 serif">八卦：万物を構成する8つのシンボル</h3>
                    <p class="mt-4 text-stone-600 max-w-2xl mx-auto leading-relaxed text-sm">
                        易の64卦は、以下の「八卦（はっけ）」の上下の組み合わせでできています。それぞれの八卦は自然界の事象と、家族構成や性質を象徴しています。
                    </p>
                </div>

                <div class="grid grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Trigram 1: Heaven -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="h-1 bg-stone-800"></div>
                                <div class="h-1 bg-stone-800"></div>
                                <div class="h-1 bg-stone-800"></div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">乾 (Ken)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">天 / 剛健</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            父、創造性、力強さ。すべてを包み込むリーダーシップと、絶え間ない進歩を象徴します。
                        </p>
                    </div>

                    <!-- Trigram 2: Earth -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">坤 (Kon)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">地 / 順応</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            母、受容性、献身。万物を育む大地のように、他者に寄り添い支える力を象徴します。
                        </p>
                    </div>

                    <!-- Trigram 3: Thunder -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="h-1 bg-stone-800"></div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">震 (Shin)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">雷 / 動感</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            長男、活動、決断。雷鳴のように人を目覚めさせ、勢いよく物事を動かすエネルギー。
                        </p>
                    </div>

                    <!-- Trigram 4: Wind -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="h-1 bg-stone-800"></div>
                                <div class="h-1 bg-stone-800"></div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">巽 (Son)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">風 / 浸透</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            長女、柔軟、調和。風のように隅々まで行き渡り、しなやかに対応する柔軟な知恵。
                        </p>
                    </div>

                    <!-- Trigram 5: Water -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="h-1 bg-stone-800"></div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">坎 (Kan)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">水 / 困難</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            次男、深層、知略。厳しい環境や心の暗部を示唆しますが、それを乗り越える強い意志。
                        </p>
                    </div>

                    <!-- Trigram 6: Fire -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="h-1 bg-stone-800"></div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="h-1 bg-stone-800"></div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">離 (Ri)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">火 / 明晰</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            次女、情熱、付着。明かりのように真実を照らし出し、美しさや直感力をもたらします。
                        </p>
                    </div>

                    <!-- Trigram 7: Mountain -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="h-1 bg-stone-800"></div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">艮 (Gon)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">山 / 静止</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            三男、堅実、内省。立ち止まる勇気や、不動の信念。今は動かず土台を固める時期。
                        </p>
                    </div>

                    <!-- Trigram 8: Marsh -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-100 hover:shadow-md transition">
                        <div class="text-center mb-4">
                            <div class="flex flex-col gap-1 w-12 mx-auto mb-3">
                                <div class="flex justify-between h-1">
                                    <div class="w-[42%] bg-stone-800"></div>
                                    <div class="w-[42%] bg-stone-800"></div>
                                </div>
                                <div class="h-1 bg-stone-800"></div>
                                <div class="h-1 bg-stone-800"></div>
                            </div>
                            <h4 class="text-xl font-bold serif text-stone-800">兌 (Da)</h4>
                            <p class="text-red-700 text-xs font-bold mt-1">沢 / 歓喜</p>
                        </div>
                        <p class="text-xs text-stone-500 leading-relaxed">
                            三女、喜び、交流。実り豊かな収穫や、人々との楽しい語らい、心の潤いを象徴します。
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- 4. Capabilities (Interactive List) -->
        <section id="capabilities" class="py-20 px-4 sm:px-6 lg:px-8 max-w-5xl mx-auto scroll-mt-16">
            <div class="text-center mb-12">
                <span
                    class="text-stone-400 font-bold tracking-widest uppercase text-xs border-b border-stone-300 pb-1">04.
                    Capabilities</span>
                <h3 class="text-3xl font-bold text-stone-800 mt-4 serif">易で「わかること」・「わからないこと」</h3>
                <p class="text-stone-600 mt-2 max-w-xl mx-auto">
                    易は万能ではありません。その特性を正しく理解することで、より深い洞察が得られます。</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Strengths -->
                <div
                    class="bg-white border border-red-100 rounded-xl p-8 relative overflow-hidden shadow-sm hover:shadow-md transition-shadow">
                    <div
                        class="absolute top-0 right-0 w-24 h-24 bg-red-50 rounded-bl-full -mr-10 -mt-10 transition-transform hover:scale-110">
                    </div>
                    <h4 class="text-xl font-bold text-red-800 mb-6 flex items-center relative z-10">
                        <span
                            class="w-8 h-8 rounded-full bg-red-100 text-red-700 flex items-center justify-center mr-3">
                            <i data-lucide="check-circle-2" class="w-5 h-5"></i>
                        </span>
                        得意なこと
                    </h4>
                    <ul class="space-y-4 relative z-10">
                        <li class="flex items-start">
                            <span class="text-red-500 mr-3 mt-1 text-sm">●</span>
                            <span class="text-stone-700 text-sm leading-6"><strong>現状の分析:</strong>
                                今、自分が置かれている状況が「登り坂」なのか「下り坂」なのか、客観的な位置を知る。</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-500 mr-3 mt-1 text-sm">●</span>
                            <span class="text-stone-700 text-sm leading-6"><strong>近い未来の吉凶:</strong>
                                特定のアクションを起こした場合、3ヶ月〜半年先にどうなるか。</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-500 mr-3 mt-1 text-sm">●</span>
                            <span class="text-stone-700 text-sm leading-6"><strong>二者択一:</strong>
                                A案とB案、どちらに進むべきか迷った時の指針。</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-red-500 mr-3 mt-1 text-sm">●</span>
                            <span class="text-stone-700 text-sm leading-6"><strong>相手の深層心理:</strong>
                                目に見えない相手の意図や、状況の裏側にある変化の兆し。</span>
                        </li>
                    </ul>
                </div>

                <!-- Weaknesses -->
                <div class="bg-stone-50 border border-stone-200 rounded-xl p-8 relative overflow-hidden">
                    <h4 class="text-xl font-bold text-stone-600 mb-6 flex items-center">
                        <span
                            class="w-8 h-8 rounded-full bg-stone-200 text-stone-500 flex items-center justify-center mr-3">
                            <i data-lucide="x-circle" class="w-5 h-5"></i>
                        </span>
                        苦手なこと
                    </h4>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <span class="text-stone-400 mr-3 mt-1 text-sm">・</span>
                            <span class="text-stone-600 text-sm leading-6"><strong>長期的な運命:</strong>
                                「一生の運勢」や「生まれ持った性格」は命術（四柱推命など）の領分です。</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-stone-400 mr-3 mt-1 text-sm">・</span>
                            <span class="text-stone-600 text-sm leading-6"><strong>絶対的な確定事項:</strong>
                                易は「変化」を示すため、未来は行動次第で変わるという前提です。</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-stone-400 mr-3 mt-1 text-sm">・</span>
                            <span class="text-stone-600 text-sm leading-6"><strong>ギャンブルの予測:</strong>
                                欲や邪念が入ると、正しい卦（け）が出ないと言われます（易占不占）。</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- How to Ask Section (New) -->
            <div class="mt-16 bg-white border border-stone-200 rounded-2xl p-8 lg:p-12 shadow-sm">
                <div class="flex flex-col md:flex-row gap-12">
                    <div class="md:w-1/3">
                        <h4 class="text-2xl font-bold text-stone-800 serif mb-4">易への正しい「問いかけ方」</h4>
                        <p class="text-stone-500 text-sm leading-relaxed">
                            易はあなたの鏡です。問いが曖昧であれば、答えも曖昧になります。より深い洞察を得るための3つのポイントを紹介します。
                        </p>
                    </div>
                    <div class="md:w-2/3 grid grid-cols-1 sm:grid-cols-2 gap-8">
                        <div>
                            <h5 class="font-bold text-stone-800 mb-2 flex items-center gap-2">
                                <span class="text-red-700">1.</span> 具体的なアクションを問う
                            </h5>
                            <p class="text-xs text-stone-600 leading-relaxed">
                                「私はどうなりますか？」という受け身の問いより、「〇〇という行動を起こした場合の成り行きは？」と、自分の主体性を入れた問いの方が明確な指針が得られます。
                            </p>
                        </div>
                        <div>
                            <h5 class="font-bold text-stone-800 mb-2 flex items-center gap-2">
                                <span class="text-red-700">2.</span> 二者択一で比較する
                            </h5>
                            <p class="text-xs text-stone-600 leading-relaxed">
                                迷いがある時は、A案とB案それぞれについて別々に占ってみましょう。卦を比較することで、それぞれの道にあるリスクや恩恵が浮き彫りになります。
                            </p>
                        </div>
                        <div>
                            <h5 class="font-bold text-stone-800 mb-2 flex items-center gap-2">
                                <span class="text-red-700">3.</span> 一度きりの真剣勝負（初筮）
                            </h5>
                            <p class="text-xs text-stone-600 leading-relaxed">
                                望まない結果が出たからと何度も占うのは、易の知恵を軽んじる行為とされます（再筮せず）。その結果をどう活かすかを考えることこそが「易」の活用法です。
                            </p>
                        </div>
                        <div class="bg-stone-50 p-4 rounded-lg border border-dashed border-stone-300">
                            <p class="text-[10px] text-stone-400 uppercase tracking-widest mb-2">Good
                                Example</p>
                            <p class="text-xs font-bold text-stone-700 italic">
                                「今、転職に向けて準備を始めるべきでしょうか、それとも今の職場で実力を蓄えるべきでしょうか？」</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 5. 64 Hexagrams Gallery (New) -->
        <section id="gallery" class="py-24 bg-stone-100 scroll-mt-16">
            <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16">
                    <span
                        class="text-stone-500 font-bold tracking-widest uppercase text-xs border-b border-stone-400 pb-1">05.
                        64 Hexagrams</span>
                    <h3 class="text-3xl font-bold text-stone-800 mt-4 serif">六十四卦の宇宙</h3>
                    <p class="mt-4 text-stone-600 max-w-2xl mx-auto leading-relaxed text-sm">
                        八卦が上下に重なることで生まれる64の物語。これらは人生のあらゆる局面、変化のあらゆるステージを網羅していると言われています。
                    </p>
                </div>

                <!-- Hexagram Grid -->
                <div id="hex-grid" class="grid grid-cols-4 gap-2">
                    <!-- Injected by JavaScript -->
                </div>

                <div class="mt-12 text-center">
                    <p class="text-[10px] text-stone-400 uppercase tracking-widest">Hover icons to see
                        the binary
                        essence</p>
                </div>
            </div>
        </section>

        <!-- 6. Interactive Simulation (The Core Experience) -->
        <section id="simulation" class="py-24 bg-[#1c1917] text-stone-100 relative overflow-hidden scroll-mt-16">
            <!-- Background Texture -->
            <div class="absolute inset-0 opacity-5 pointer-events-none"
                style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48ZyBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9MTAgNDBoNDBWMEgwVjQwem0yMCAyMGgyMHYyMEgyMFY2MHoiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iMSIvPjwvZz48L3N2Zz4=');">
            </div>

            <div class="max-w-5xl mx-auto px-4 relative z-10">
                <div class="text-center mb-12">
                    <span
                        class="text-amber-500 font-bold tracking-widest uppercase text-xs border-b border-amber-500 pb-1">06.
                        Simulation</span>
                    <h3 class="text-4xl font-bold text-white mt-4 serif">実践：擲銭法（てきせんほう）</h3>
                    <p class="text-stone-400 mt-4 max-w-2xl mx-auto leading-relaxed">
                        伝統的な筮竹（ぜいちく）の代わりに、3枚のコインを使う簡便法を体験しましょう。<br>
                        心を落ち着け、問いかけを念じながら「コインを投げる」ボタンを6回押してください。<br>
                        下から順に線（爻）が積み上がり、あなたの卦（Hexagram）が完成します。
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start">
                    <!-- Control Panel -->
                    <div class="bg-stone-800 p-8 rounded-2xl shadow-2xl border border-stone-700">
                        <h4 class="text-xl font-bold text-amber-500 mb-6 serif flex items-center justify-between">
                            <span>手順 (Steps)</span>
                            <span id="step-counter" class="text-sm bg-stone-900 px-2 py-1 rounded text-stone-400">0 /
                                6</span>
                        </h4>

                        <div class="space-y-8">
                            <div id="step-desc" class="text-base text-stone-300 min-h-[60px] leading-relaxed">
                                1. まず、占いたい具体的な問いを心に思い浮かべてください。準備ができたら「開始」を押します。
                            </div>

                            <!-- Coins Display -->
                            <div
                                class="flex justify-center space-x-6 my-4 bg-stone-900 p-6 rounded-xl h-32 items-center border-t border-b border-stone-700/50">
                                <div class="coin-container">
                                    <div id="coin1" class="coin text-2xl shadow-amber-500/20">?</div>
                                </div>
                                <div class="coin-container">
                                    <div id="coin2" class="coin text-2xl shadow-amber-500/20">?</div>
                                </div>
                                <div class="coin-container">
                                    <div id="coin3" class="coin text-2xl shadow-amber-500/20">?</div>
                                </div>
                            </div>

                            <div class="flex flex-col gap-3">
                                <button id="tossBtn" onclick="tossCoins()"
                                    class="w-full bg-gradient-to-r from-red-800 to-red-700 hover:from-red-700 hover:to-red-600 text-white font-bold py-4 rounded-xl shadow-lg transition transform active:scale-[0.98] text-lg border border-red-900 tracking-wide">
                                    コインを投げる
                                </button>
                                <button id="resetBtn" onclick="resetDivination()"
                                    class="w-full bg-stone-700 hover:bg-stone-600 text-stone-300 font-bold py-3 rounded-xl transition hidden border border-stone-600">
                                    リセットして最初から
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Result Panel (Hexagram Builder) -->
                    <div
                        class="bg-[#f5f5f4] p-8 rounded-2xl shadow-2xl text-stone-900 min-h-[500px] flex flex-col relative overflow-hidden">
                        <!-- Background Pattern -->
                        <div class="absolute inset-0 opacity-30 flex items-center justify-center pointer-events-none">
                            <div class="w-64 h-64 rounded-full border-[20px] border-stone-200"></div>
                        </div>

                        <div class="absolute top-4 right-4 text-[10px] uppercase text-stone-400 tracking-widest">
                            Future
                            (上卦)</div>
                        <div class="absolute bottom-4 right-4 text-[10px] uppercase text-stone-400 tracking-widest">
                            Past
                            (下卦)</div>

                        <!-- The Hexagram Stack -->
                        <div id="hexagram-container"
                            class="flex flex-col-reverse w-full max-w-[240px] mx-auto gap-3 py-10 z-10 flex-grow justify-center">
                            <!-- Lines will be injected here by JS -->
                            <div class="h-full flex flex-col items-center justify-center text-stone-400 italic space-y-4"
                                id="empty-state">
                                <i data-lucide="layers" class="w-12 h-12 opacity-20"></i>
                                <span class="text-sm">コインを投げると、<br>ここに卦（け）が現れます</span>
                            </div>
                        </div>

                        <!-- Result Text -->
                        <div id="result-text"
                            class="mt-4 pt-6 border-t border-stone-300 text-center hidden fade-in z-10 bg-white/80 backdrop-blur-sm rounded-lg p-4 mx-[-10px] mb-[-10px]">
                            <h5 class="text-xl font-bold serif mb-2 text-stone-800" id="hex-name">--
                            </h5>
                            <p class="text-sm text-stone-600 leading-6 text-left" id="hex-desc">--</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-stone-50 py-20 border-t border-stone-200/60">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex flex-col items-center text-center space-y-12">
                    <!-- Brand section -->
                    <div class="space-y-6">
                        <div class="flex justify-center">
                            <div
                                class="w-14 h-14 bg-red-900/5 rounded-2xl flex items-center justify-center border border-red-900/10 shadow-sm">
                                <i data-lucide="hexagon" class="w-7 h-7 text-red-900"></i>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-slate-900 serif tracking-tight">
                                Triscope <span class="text-red-700">I Ching</span>
                            </h3>
                            <p class="text-[10px] uppercase tracking-[0.3em] font-bold text-slate-400 mt-1">Ancient
                                Oracle × Binary Wisdom</p>
                        </div>
                        <p class="text-sm max-w-md mx-auto leading-relaxed text-slate-600 font-medium">
                            古代の叡智「易」を現代のデジタル技術でシミュレート。変化し続ける宇宙の法則を読み解き、最善の道を見出すためのツール。
                        </p>
                    </div>

                    <!-- Horizontal line and Copyright -->
                    <div
                        class="w-full pt-10 border-t border-stone-200/80 flex flex-col md:flex-row justify-between items-center gap-6 text-[10px] uppercase tracking-widest font-bold text-slate-400">
                        <span>© 2026 Triscope Project. All rights reserved.</span>
                        <div class="flex gap-8">
                            <span class="hover:text-red-700 transition-colors cursor-default">Ancient Oracle</span>
                            <span class="hover:text-red-700 transition-colors cursor-default">Binary Wisdom</span>
                        </div>
                    </div>

                    <!-- Footer Disclaimer Card -->
                    <div class="bg-white/50 px-6 py-4 rounded-xl border border-stone-200/50 max-w-3xl">
                        <p class="text-[10px] text-slate-400 leading-relaxed italic">
                            ※本レポートは易経の概念を学習・体験するための教育的シミュレーションです。実際の結果は、コイン（裏・表）の組み合わせによる「老陰・少陽・少陰・老陽」の変化によって導き出されます。
                        </p>
                    </div>
                </div>
            </div>
        </footer>

    </main>

    <script>
        // --- Navigation Logic ---
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                const headerOffset = 64;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });
                // If mobile menu is open, close it (logic purely via DOM)
                document.getElementById('mobile-menu').classList.add('hidden');
            }
        }

        // --- Chart.js Logic (Yin/Yang Visualization) ---
        let yinYangChart;

        function initChart() {
            const ctx = document.getElementById('yinYangChart').getContext('2d');

            // Custom plugin to draw text in center (optional but nice)
            const centerTextPlugin = {
                id: 'centerText',
                beforeDraw: function (chart) {
                    var width = chart.width, height = chart.height, ctx = chart.ctx;
                    ctx.restore();
                    var fontSize = (height / 10).toFixed(2);
                    ctx.font = "bold " + fontSize + "px 'Noto Serif JP'";
                    ctx.textBaseline = "middle";
                    ctx.fillStyle = "#57534e"; // Stone 600
                    var text = "太極",
                        textX = Math.round((width - ctx.measureText(text).width) / 2),
                        textY = height / 2;
                    ctx.fillText(text, textX, textY);
                    ctx.save();
                }
            };

            yinYangChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['陽 (Yang)', '陰 (Yin)'],
                    datasets: [{
                        data: [32, 32], // Initial balanced state
                        backgroundColor: ['#1c1917', '#e5e5e5'], // Dark for Yang, Light for Yin
                        borderColor: '#fafaf9',
                        borderWidth: 2,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { family: "'Noto Serif JP', serif" },
                                color: '#57534e',
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const label = context.label || '';
                                    const value = context.raw;
                                    const percentage = Math.round((value / 64) * 100) + '%';
                                    return ` ${label}: ${percentage}`;
                                }
                            },
                            backgroundColor: 'rgba(28, 25, 23, 0.9)',
                            padding: 12
                        }
                    }
                },
                plugins: [centerTextPlugin]
            });
        }

        function updateChartData(type) {
            if (!yinYangChart) return;

            let newData;
            // Demonstrating the shifting balance of 64 hexagrams potential
            if (type === 'balanced') newData = [32, 32];
            else if (type === 'yang') newData = [50, 14];
            else if (type === 'yin') newData = [14, 50];

            yinYangChart.data.datasets[0].data = newData;
            yinYangChart.update();
        }

        // --- Simulation Logic (Virtual I Ching) ---

        let tossCount = 0;
        let hexagramLines = []; // Array to store 6 lines (values 6,7,8,9)
        const maxTosses = 6;

        // Coin logic: Heads = 3, Tails = 2.
        // 3 coins sum: 
        // 3+3+3 = 9 (Old Yang - Changing)
        // 3+3+2 = 8 (Young Yin - Stable)
        // 3+2+2 = 7 (Young Yang - Stable)
        // 2+2+2 = 6 (Old Yin - Changing)

        function tossCoins() {
            const btn = document.getElementById('tossBtn');
            const stepDesc = document.getElementById('step-desc');
            const emptyState = document.getElementById('empty-state');
            const counter = document.getElementById('step-counter');

            if (emptyState) emptyState.style.display = 'none';

            if (tossCount >= maxTosses) return;

            // Animate coins
            const coinEls = [document.getElementById('coin1'), document.getElementById('coin2'), document.getElementById('coin3')];
            coinEls.forEach(c => {
                // Reset rotation
                c.style.transition = 'none';
                c.classList.remove('flip');
                void c.offsetWidth; // trigger reflow
                // Add flip animation
                c.style.transition = 'transform 0.6s ease-out';
                c.classList.add('flip');
            });

            // Disable button during animation
            btn.disabled = true;
            btn.classList.add('opacity-50', 'cursor-not-allowed');
            btn.innerHTML = `<span class="animate-pulse">運命を計算中...</span>`;

            setTimeout(() => {
                // Calculate Result
                let total = 0;
                coinEls.forEach(c => {
                    c.classList.remove('flip');
                    // Random 2 or 3 (2=Tails/Yin, 3=Heads/Yang)
                    const val = Math.random() < 0.5 ? 2 : 3;
                    total += val;

                    // Visual update of coins
                    if (val === 3) {
                        c.innerText = "陽"; // Heads
                        c.style.backgroundColor = "#b91c1c"; // Red
                        c.style.color = "white";
                    } else {
                        c.innerText = "陰"; // Tails
                        c.style.backgroundColor = "#d6d3d1"; // Grey
                        c.style.color = "#1c1917";
                    }
                });

                // Process Line
                addLineToHexagram(total);
                tossCount++;
                counter.innerText = `${tossCount} / 6`;

                // Update UI text
                if (tossCount < maxTosses) {
                    stepDesc.innerHTML = `<span class="text-amber-500 font-bold">${tossCount}回目</span>の結果: 合計${total}。<br>次のラインを積み上げます。集中を持続してください。`;
                    btn.innerText = `次のコインを投げる`;
                    btn.disabled = false;
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    stepDesc.innerHTML = `<span class="text-amber-500 font-bold">完了</span>: 6本のラインが揃いました。あなたの問いに対する答えが表示されます。`;
                    finishDivination();
                }

            }, 600);
        }

        function addLineToHexagram(value) {
            const container = document.getElementById('hexagram-container');
            const lineWrapper = document.createElement('div');
            lineWrapper.className = "w-full flex items-center relative fade-in group mb-1";

            const lineContent = document.createElement('div');
            lineContent.className = "flex-grow relative px-8"; // Add padding to make space for absolute markers

            let lineHTML = '';
            let markerHTML = '';
            let lineLabel = '';

            if (value === 9 || value === 7) {
                lineHTML = `<div class="hex-line yang bg-stone-900 h-3 w-full rounded-sm shadow-sm transition-all group-hover:bg-red-900"></div>`;
                lineLabel = (value === 9) ? "老陽 (変)" : "少陽";
                if (value === 9) markerHTML = `<span class="absolute right-0 top-[-6px] text-red-600 text-xl font-bold">○</span>`;
            } else {
                lineHTML = `<div class="hex-line yin flex justify-between w-full h-3">
                    <div class="hex-line-segment shadow-sm transition-all group-hover:bg-red-900"></div>
                    <div class="hex-line-segment shadow-sm transition-all group-hover:bg-red-900"></div>
                </div>`;
                lineLabel = (value === 6) ? "老陰 (変)" : "少陰";
                if (value === 6) markerHTML = `<span class="absolute right-0 top-[-6px] text-red-600 text-xl font-bold">✕</span>`;
            }

            lineContent.innerHTML = lineHTML + markerHTML;
            lineWrapper.appendChild(lineContent);
            lineWrapper.title = lineLabel;

            container.appendChild(lineWrapper);
            hexagramLines.push(value);
        }

        function finishDivination() {
            const btn = document.getElementById('tossBtn');
            const resetBtn = document.getElementById('resetBtn');
            const resultText = document.getElementById('result-text');
            const hexName = document.getElementById('hex-name');
            const hexDesc = document.getElementById('hex-desc');

            btn.classList.add('hidden');
            resetBtn.classList.remove('hidden');

            const trigramSymbols = {
                "YYY": { name: "天", symbol: "乾" },
                "yyy": { name: "地", symbol: "坤" },
                "yyY": { name: "雷", symbol: "震" },
                "YYy": { name: "風", symbol: "巽" },
                "yYy": { name: "水", symbol: "坎" },
                "YyY": { name: "火", symbol: "離" },
                "yYY": { name: "山", symbol: "艮" },
                "Yyy": { name: "沢", symbol: "兌" }
            };

            const getTrigramInfo = (lines) => {
                const pattern = lines.map(l => (l === 7 || l === 9) ? "Y" : "y").join("");
                return trigramSymbols[pattern];
            };

            const lower = getTrigramInfo(hexagramLines.slice(0, 3));
            const upper = getTrigramInfo(hexagramLines.slice(3, 6));

            // 64 Hexagram simple titles logic
            const hexMap = {
                "天天": "乾為天: 強力な前進、創造の最高潮",
                "地地": "坤為地: 柔順、受容、大地のような調和",
                "水雷": "水雷屯: 産みの苦しみ、慎重な出発",
                "山水": "山水蒙: 啓蒙、教育、未熟さからの学び",
                "水天": "水天需: 待機、忍耐、好機を待つ",
                "天水": "天水訟: 争い、訴訟、衝突の回避が吉",
                "地水": "地水師: 統率、組織、困難に挑む軍隊",
                "水地": "水地比: 親和、協力、人との絆",
                "風天": "風天小畜: 小さな蓄え、足踏み状態",
                "天沢": "天沢履: 危険を伴う歩み、誠実さ",
                "地天": "地天泰: 安泰、平和、萬事順調",
                "天地": "天地否: 閉塞、不一致、衰退の兆し",
                "天火": "天同人: 協力、志を同じくする者",
                "火天": "火天大有: 豊穣、繁栄、大いなる所有",
                "地山": "地山謙: 謙虚、慎み、徳を積む",
                "雷地": "雷地予: 予感、喜び、準備と計画",
                "沢雷": "沢雷随: 追従、柔軟性、流れに任せる",
                "山風": "山風蠱: 腐敗、刷新、立て直し",
                "地臨": "地臨: 到来、臨む、成長の初期",
                "風地": "風地観: 観察、熟考、洞察力",
                "火雷": "火雷噬嗑: 障害の除去、断固たる決断",
                "山火": "山火賁: 装飾、外面の美、内実の伴い",
                "山地": "山地剥: 崩壊、剥落、今は耐える時",
                "地雷": "地雷復: 回復、復活、再び始まる",
                "天雷": "天雷无妄: 自然体、作為のない誠実",
                "山天": "山天大畜: 大いなる蓄積、実力の涵養",
                "山雷": "山雷頤: 養生、口、栄養と節制",
                "沢風": "沢風大過: 重荷、過剰、思い切った処置",
                "水水": "坎為水: 重なる困難、知略での突破",
                "火火": "離為火: 明晰、知性、情熱の持続",
                "沢山": "沢山咸: 感応、共鳴、惹かれ合う心",
                "雷風": "雷風恒: 永続、恒常、変わらぬ信念",
                "天山": "天山遯: 隠遁、退避、身を守る智慧",
                "雷天": "雷天大壮: 盛大、勢い、行き過ぎに注意",
                "火地": "火地晋: 進出、昇進、輝かしい発展",
                "地火": "地火明夷: 苦難、隠れる、暗闇での忍耐",
                "風火": "風火家人: 家庭、内面の秩序、誠意",
                "火沢": "火沢睽: 背離、違和感、異質な融合",
                "水山": "水山蹇: 足踏み、困難、止まって熟考",
                "雷水": "雷水解: 解消、解放、問題の解決",
                "山沢": "山沢損: 減少、奉仕、まず与えること",
                "風雷": "風雷益: 利益、増加、積極的な進歩",
                "沢天": "沢天夬: 決断、突破、断固たる態度",
                "天風": "天風姤: 出会い、偶然、予期せぬ誘惑",
                "沢地": "沢地萃: 集合、繁栄、人々が集まる",
                "地風": "地風升: 上昇、昇進、地道な努力",
                "沢水": "沢水困: 困窮、行き詰まり、精神の鍛錬",
                "水風": "水風井: 生命の源、井戸、普遍的な価値",
                "沢火": "沢火革: 変革、改革、古いものを捨てる",
                "火風": "火風鼎: 安定、三者の協力、新たな確立",
                "雷雷": "震為雷: 衝撃、変革の予兆、落ち着き",
                "山山": "艮為山: 停止、不動、自己を律する",
                "風山": "風山漸: 漸進、着実な歩み、順序",
                "雷沢": "雷沢帰妹: 順序の誤り、無理な進展",
                "雷火": "雷火豊: 豊盛、頂点、盛者必衰の戒め",
                "火山": "火山旅: 孤独、不安定、旅路の教訓",
                "風風": "巽為風: 柔軟、浸透、謙虚な従順",
                "沢沢": "兌為沢: 喜び、対話、心の和らぎ",
                "風水": "風水渙: 解散、霧散、古い殻を破る",
                "水沢": "水沢節: 節度、制約、適切な区切り",
                "風沢": "風中孚: 誠実、真実、心からの共鳴",
                "雷山": "雷山小過: 少しの行き過ぎ、日常の遵守",
                "水火": "水火既済: 完成、成就、その後の油断",
                "火水": "火水未済: 未完成、希望の残存、再出発"
            };

            const key = upper.name + lower.name;
            const hexDetail = hexMap[key] || "未知の卦: 変化の真っ只中にあります。";

            hexName.innerText = `易占の結果：【${hexDetail.split(': ')[0]}】`;

            let interpretation = `心に浮かべた問いに対し、宇宙はこの象（かたち）を示しました。<br>
                                 <span class="text-xs bg-stone-100 px-3 py-1 rounded text-stone-500 inline-block mt-3 border border-stone-200 shadow-sm">${upper.symbol}(${upper.name}) ／ ${lower.symbol}(${lower.name})</span>`;

            interpretation += `<div class="mt-6 p-4 bg-white border border-red-50 rounded-lg shadow-inner">
                                <p class="text-stone-800 font-bold mb-2">総評: ${hexDetail.split(': ')[1]}</p>
                                <p class="text-xs text-stone-600 leading-relaxed">
                                    この卦は「${upper.name}」という外的な勢いと、「${lower.name}」という内面的な状態が重なることで生まれる物語です。
                                </p>
                              </div>`;

            const isDynamic = hexagramLines.some(l => l === 6 || l === 9);
            if (isDynamic) {
                interpretation += `<div class="mt-6 animate-pulse border-l-4 border-amber-500 pl-4 py-1">
                                    <p class="text-sm font-bold text-amber-800">【変爻（へんこう）あり】変化の真っ只中</p>
                                    <p class="text-xs text-stone-600 mt-1">
                                        現在は「${hexDetail.split(': ')[0]}」の状態にありますが、内部に「老」「極」のラインが含まれています。これは状況が裏返り、別の卦へと移行しようとしている動的な局面であることを意味します。結果を固定せず、変化の兆しを読み取ってください。
                                    </p>
                                  </div>`;
            } else {
                interpretation += `<div class="mt-6 border-l-4 border-stone-400 pl-4 py-1">
                                    <p class="text-sm font-bold text-stone-800">【不変の卦】安定の時</p>
                                    <p class="text-xs text-stone-600 mt-1">
                                        変化を示すラインが含まれていません。これは今すぐ状況が劇的に変わることはなく、この卦が示すエネルギーがしばらく持続することを意味します。地道な対応が鍵となります。
                                    </p>
                                  </div>`;
            }

            interpretation += "<br><div class='text-left bg-stone-50 p-4 rounded text-[11px] text-stone-500 space-y-2 border border-stone-100'><strong>💡 易の知恵:</strong><br>結果を単なる吉凶ではなく「今の自分を映す鏡」として捉えてみてください。一番下のラインから順に、時間軸に沿った物語として解釈を深めることができます。</div>";

            hexDesc.innerHTML = interpretation;
            resultText.classList.remove('hidden');
        }

        function resetDivination() {
            tossCount = 0;
            hexagramLines = [];
            document.getElementById('hexagram-container').innerHTML = '<div class="h-full flex flex-col items-center justify-center text-stone-400 italic space-y-4" id="empty-state"><span class="text-4xl opacity-20">☰</span><span class="text-sm">コインを投げると、<br>ここに卦（け）が現れます</span></div>';
            document.getElementById('tossBtn').classList.remove('hidden');
            document.getElementById('tossBtn').innerText = "コインを投げる";
            document.getElementById('tossBtn').disabled = false;
            document.getElementById('tossBtn').classList.remove('opacity-50', 'cursor-not-allowed');
            document.getElementById('resetBtn').classList.add('hidden');
            document.getElementById('result-text').classList.add('hidden');
            document.getElementById('step-desc').innerText = "1. まず、占いたい具体的な問いを心に思い浮かべてください。準備ができたら「開始」を押します。";
            document.getElementById('step-counter').innerText = "0 / 6";

            // Reset coins
            const coins = document.querySelectorAll('.coin');
            coins.forEach(c => {
                c.innerText = "?";
                c.style.backgroundColor = "#d97706";
                c.style.color = "white";
            });
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const btn = document.getElementById('mobile-menu-btn');
            const isHidden = menu.classList.toggle('hidden');
            btn.innerHTML = isHidden ? '<i data-lucide="menu" class="w-6 h-6"></i>' : '<i data-lucide="x" class="w-6 h-6"></i>';
            lucide.createIcons();
        }
        document.getElementById('mobile-menu-btn').addEventListener('click', toggleMobileMenu);

        // --- Hexagram Gallery Generation ---
        function initGallery() {
            const grid = document.getElementById('hex-grid');
            if (!grid) return;

            const trigramMap = {
                "111": "乾（天）",
                "000": "坤（地）",
                "001": "震（雷）",
                "110": "巽（風）",
                "010": "坎（水）",
                "101": "離（火）",
                "011": "艮（山）",
                "100": "兌（沢）"
            };

            // Generate 64 hexagrams based on binary 0-63
            for (let i = 0; i < 64; i++) {
                const hexWrapper = document.createElement('div');

                // Get Lower/Upper patterns for tooltip
                const lowerPattern = ((i >> 0) & 1).toString() + ((i >> 1) & 1).toString() + ((i >> 2) & 1).toString();
                const upperPattern = ((i >> 3) & 1).toString() + ((i >> 4) & 1).toString() + ((i >> 5) & 1).toString();
                const lowerName = trigramMap[lowerPattern] || "?";
                const upperName = trigramMap[upperPattern] || "?";

                hexWrapper.className = "bg-white p-2 border border-stone-200 rounded flex flex-col items-center justify-center hover:border-red-400 cursor-help transition-colors group";
                hexWrapper.title = `上卦: ${upperName} / 下卦: ${lowerName}`;

                const hexLines = document.createElement('div');
                hexLines.className = "flex flex-col-reverse gap-[2px] w-full";

                // 6 lines
                for (let line = 0; line < 6; line++) {
                    const lineDiv = document.createElement('div');
                    lineDiv.className = "h-[3px] w-full";
                    const isYang = (i >> line) & 1;
                    if (isYang) {
                        lineDiv.className += " bg-stone-800";
                    } else {
                        lineDiv.className += " flex justify-between";
                        lineDiv.innerHTML = '<div class="w-[42%] bg-stone-800 h-full"></div><div class="w-[42%] bg-stone-800 h-full"></div>';
                    }
                    hexLines.appendChild(lineDiv);
                }

                const label = document.createElement('span');
                label.className = "text-[7px] text-stone-400 mt-1 font-mono group-hover:text-red-600 transition-colors";
                label.innerText = i.toString(2).padStart(6, '0');

                hexWrapper.appendChild(hexLines);
                hexWrapper.appendChild(label);
                grid.appendChild(hexWrapper);
            }
        }

        // --- Initialization ---
        window.addEventListener('DOMContentLoaded', () => {
            initChart();
            initGallery();
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });

    </script>
</body>

</html>