<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>おみくじ：神仏からのメッセージ</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts (統一フォント) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&family=Noto+Serif+JP:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <!-- 共通CSS -->
    <link rel="stylesheet" href="../../assets/common.css">

    <!-- Chosen Palette: Wa-Modern (Japanese Modern) -->
    <!-- Background: Washi White (#F9F7F2) -->
    <!-- Primary Text: Sumi Ink (#2D2D2D) -->
    <!-- Accent: Torii Vermilion (#C83E28) -->
    <!-- Secondary: Bamboo Green (#6A7B54) -->
    <!-- Highlight: Gold Leaf (#D4AF37) -->

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'washi': '#F9F7F2',
                        'sumi': '#2D2D2D',
                        'torii': '#C83E28',
                        'bamboo': '#6A7B54',
                        'gold': '#D4AF37',
                        'indigo': '#2B4F69',
                    },
                    fontFamily: {
                        'serif': ['"Noto Serif JP"', 'serif'],
                        'sans': ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* bodyスタイルは common.css で定義 */
        /* h1-h6スタイルは common.css で定義 */

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 350px;
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .timeline-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #CBD5E1;
            transform: translateX(-50%);
        }

        .timeline-dot {
            transition: all 0.3s ease;
        }

        .timeline-item:hover .timeline-dot {
            background-color: #C83E28;
            transform: scale(1.2);
        }

        .fade-in {
            animation: fadeIn 0.8s ease-in forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #F9F7F2;
        }

        ::-webkit-scrollbar-thumb {
            background: #C83E28;
            border-radius: 4px;
        }
    </style>

    <!-- Application Structure Plan:
        1. Hero Section: Sets the tone, introduces Omikuji as a divine message.
        2. Overview & Logic (Bokusho): Explains the "Type" of fortune telling and the logic of Synchronicity using cards and a Radar chart comparing it to other methods.
        3. Capabilities (Analytics): Uses a Doughnut chart to show traditional luck ratios (quantitative view of qualitative data) and a list of what it tells/doesn't tell.
        4. History (Timeline): A vertical timeline to visualize the evolution from Ryogen Daishi to modern times.
        5. Ritual (Method): An interactive stepper guide to teach the proper etiquette, transforming passive reading into active learning.
        6. Virtual Simulation: A fun, random generator to reinforce the concept of "chance" and "divine message".
    -->

    <!-- Visualization & Content Choices:
        1. Radar Chart: Goal -> Compare. Viz -> Radar Chart. Justification -> Effectively shows how Omikuji differs from Astrology (Life) and Physiognomy (Form) in terms of immediacy, randomness, and specificity.
        2. Doughnut Chart: Goal -> Inform. Viz -> Doughnut Chart. Justification -> Visualizes the traditional probability distribution of luck (Dai-kichi vs others) to debunk the idea that it's "mostly good luck".
        3. Timeline: Goal -> Organize. Viz -> Vertical HTML Flow. Justification -> Best for showing chronological progression without complex libraries.
        4. Stepper: Goal -> Change/Teach. Viz -> Interactive DOM manipulation. Justification -> Breaks down the ritual into digestible actions.
    -->

    <!-- CONFIRMATION: NO SVG graphics used (Chart.js uses Canvas). NO Mermaid JS used. -->
</head>

<body>
    <!-- Triscope共通ナビゲーション -->
    <nav class="triscope-nav">
        <a href="../../index.html" class="triscope-nav-home">
            <span>🏠</span>
            <span>ホームに戻る</span>
        </a>
    </nav>


    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-washi/90 backdrop-blur-md border-b border-stone-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <span class="text-2xl text-torii font-serif font-bold tracking-widest">おみくじ</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <button onclick="scrollToSection('overview')"
                        class="text-sumi hover:text-torii transition-colors font-medium">概要と論理</button>
                    <button onclick="scrollToSection('analysis')"
                        class="text-sumi hover:text-torii transition-colors font-medium">読み解き</button>
                    <button onclick="scrollToSection('history')"
                        class="text-sumi hover:text-torii transition-colors font-medium">歴史</button>
                    <button onclick="scrollToSection('ritual')"
                        class="text-sumi hover:text-torii transition-colors font-medium">作法</button>
                </div>
                <div class="md:hidden">
                    <!-- Mobile menu button placeholder -->
                    <button class="text-sumi p-2" onclick="toggleMobileMenu()">☰</button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-washi border-t border-stone-200 px-4 py-2 shadow-lg">
            <button onclick="scrollToSection('overview')"
                class="block w-full text-left py-2 text-sumi hover:bg-stone-100">概要と論理</button>
            <button onclick="scrollToSection('analysis')"
                class="block w-full text-left py-2 text-sumi hover:bg-stone-100">読み解き</button>
            <button onclick="scrollToSection('history')"
                class="block w-full text-left py-2 text-sumi hover:bg-stone-100">歴史</button>
            <button onclick="scrollToSection('ritual')"
                class="block w-full text-left py-2 text-sumi hover:bg-stone-100">作法</button>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative bg-stone-100 py-24 sm:py-32 overflow-hidden">
        <div class="absolute inset-0 pattern-dots opacity-10"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
            <h1 class="text-5xl md:text-7xl font-bold text-sumi mb-6 tracking-widest fade-in">神意を占う</h1>
            <p class="text-xl md:text-2xl text-stone-600 mb-10 font-light fade-in" style="animation-delay: 0.2s;">
                偶然の中に宿る必然。<br>おみくじの歴史、論理、そして正しい作法へ。
            </p>
            <button onclick="scrollToSection('overview')"
                class="inline-block bg-torii text-white px-8 py-3 rounded-full text-lg font-bold shadow-lg hover:bg-red-700 transition-transform transform hover:-translate-y-1 fade-in"
                style="animation-delay: 0.4s;">
                探求を始める
            </button>
        </div>
        <!-- Decorative Circle -->
        <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] border border-stone-300 rounded-full opacity-30 pointer-events-none">
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 space-y-24">

        <!-- Section 1: Overview & Logic -->
        <section id="overview" class="scroll-mt-24">
            <div class="text-center mb-12">
                <span class="text-torii font-bold tracking-widest text-sm uppercase">Overview & Logic</span>
                <h2 class="text-3xl md:text-4xl font-bold mt-2">「卜術」としての特性</h2>
                <p class="mt-4 text-stone-600 max-w-2xl mx-auto">
                    おみくじは、数ある占いの中でも「偶然性」を最重要視する占術です。その特性を他の占いと比較しながら紐解きます。
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <!-- Text Content -->
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-torii">
                        <h3 class="text-xl font-bold mb-2 flex items-center">
                            <span class="text-2xl mr-2">🎲</span> 偶然性 (シンクロニシティ)
                        </h3>
                        <p class="text-stone-600 leading-relaxed">
                            おみくじは「卜術（ぼくじゅつ）」に分類されます。生年月日（命術）や顔の形（相術）のような固定されたデータではなく、「その瞬間に引いた偶然」にこそ神仏の意志が宿るという考えに基づいています。これを心理学的には「共時性（シンクロニシティ）」と呼びます。
                        </p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-bamboo">
                        <h3 class="text-xl font-bold mb-2 flex items-center">
                            <span class="text-2xl mr-2">⚡</span> 短期的な指針
                        </h3>
                        <p class="text-stone-600 leading-relaxed">
                            長期的な宿命ではなく、「今、どうすべきか」という短期的な問いや、具体的な迷いに対して、現状を打破するためのヒントを与えてくれるのが特徴です。
                        </p>
                    </div>
                </div>

                <!-- Radar Chart Container -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-center font-bold mb-4 text-stone-500">占術タイプの比較</h3>
                    <div class="chart-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                    <p class="text-xs text-center text-stone-400 mt-2">※一般的な特性の比較イメージです</p>
                </div>
            </div>
        </section>

        <!-- Section 2: What it Tells You (Analysis) -->
        <section id="analysis" class="scroll-mt-24 bg-stone-50 rounded-3xl p-8 md:p-12">
            <div class="text-center mb-12">
                <span class="text-bamboo font-bold tracking-widest text-sm uppercase">Insights</span>
                <h2 class="text-3xl md:text-4xl font-bold mt-2">おみくじで「わかること」</h2>
                <p class="mt-4 text-stone-600 max-w-2xl mx-auto">
                    吉凶の結果だけに一喜一憂していませんか？おみくじの真価は、細部に記された具体的なアドバイスにあります。
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <!-- Doughnut Chart: Luck Ratio -->
                <div class="flex flex-col items-center">
                    <h3 class="text-xl font-bold mb-4">伝統的な吉凶の配分（元三大師版）</h3>
                    <div class="chart-container">
                        <canvas id="luckChart"></canvas>
                    </div>
                    <div class="mt-6 text-sm text-stone-500 text-center max-w-xs">
                        <p>古来の伝統的な配分では、「凶」が意外に多く含まれています。これは「戒め」としての意味合いが強いためです。</p>
                    </div>
                </div>

                <!-- Capabilities List -->
                <div class="space-y-4">
                    <h3 class="text-xl font-bold mb-4">得意・不得意分野</h3>

                    <!-- Interactive Toggle Cards -->
                    <div class="space-y-4">
                        <div class="bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer hover:shadow-md transition-shadow"
                            onclick="toggleDetail('know-1')">
                            <div class="p-4 flex justify-between items-center bg-indigo-50">
                                <span class="font-bold text-indigo-900">⭕ わかること：現在の運気の波</span>
                                <span class="text-indigo-400">▼</span>
                            </div>
                            <div id="know-1" class="p-4 text-stone-600 hidden">
                                今が「攻め時」か「待ち時」かというバイオリズムを示します。「大吉」はピーク、「凶」はこれから上がる準備期間と捉えます。
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer hover:shadow-md transition-shadow"
                            onclick="toggleDetail('know-2')">
                            <div class="p-4 flex justify-between items-center bg-indigo-50">
                                <span class="font-bold text-indigo-900">⭕ わかること：具体的な項目の指針</span>
                                <span class="text-indigo-400">▼</span>
                            </div>
                            <div id="know-2" class="p-4 text-stone-600 hidden">
                                「待ち人（来るか来ないか）」「失せ物（出るか出ないか）」「商売」「学問」など、具体的なテーマに対するイエス/ノーに近いヒントが得られます。
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer hover:shadow-md transition-shadow"
                            onclick="toggleDetail('dont-know-1')">
                            <div class="p-4 flex justify-between items-center bg-red-50">
                                <span class="font-bold text-red-900">❌ わからないこと：生まれ持った性格</span>
                                <span class="text-red-400">▼</span>
                            </div>
                            <div id="dont-know-1" class="p-4 text-stone-600 hidden">
                                生年月日を使う占いではないため、あなたの本質的な性格や才能の分析はできません。あくまで「現在の状況」に対する答えです。
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow-sm overflow-hidden cursor-pointer hover:shadow-md transition-shadow"
                            onclick="toggleDetail('dont-know-2')">
                            <div class="p-4 flex justify-between items-center bg-red-50">
                                <span class="font-bold text-red-900">❌ わからないこと：絶対的な未来</span>
                                <span class="text-red-400">▼</span>
                            </div>
                            <div id="dont-know-2" class="p-4 text-stone-600 hidden">
                                おみくじの結果は「確定した未来」ではありません。心がけ次第で変わる「可変的な未来」の予測に過ぎません。
                            </div>
                        </div>
                    </div>
                    <p class="text-xs text-right text-stone-400 mt-2">クリックして詳細を表示</p>
                </div>
            </div>
        </section>

        <!-- Section 3: History -->
        <section id="history" class="scroll-mt-24">
            <div class="text-center mb-12">
                <span class="text-gold font-bold tracking-widest text-sm uppercase">History</span>
                <h2 class="text-3xl md:text-4xl font-bold mt-2">おみくじの変遷</h2>
                <p class="mt-4 text-stone-600 max-w-2xl mx-auto">
                    古代の神意伺いから、現代のエンターテインメントまで。おみくじが歩んできた歴史を辿ります。
                </p>
            </div>

            <div class="relative max-w-3xl mx-auto py-10">
                <!-- Vertical Line -->
                <div class="timeline-line"></div>

                <!-- Timeline Item 1 -->
                <div
                    class="timeline-item relative mb-16 pl-0 md:pl-1/2 w-full flex flex-col md:flex-row items-center md:items-start group">
                    <div class="hidden md:block w-1/2 pr-8 text-right order-1">
                        <h4 class="text-xl font-bold text-torii">古代〜平安</h4>
                        <p class="text-stone-500 font-serif">神意を問う「籤（くじ）」の始まり</p>
                    </div>
                    <div
                        class="absolute left-1/2 transform -translate-x-1/2 w-6 h-6 rounded-full bg-washi border-4 border-stone-300 z-10 timeline-dot order-2">
                    </div>
                    <div class="w-full md:w-1/2 mt-4 md:mt-0 px-4 md:pl-8 order-3">
                        <div class="md:hidden mb-2">
                            <h4 class="text-xl font-bold text-torii">古代〜平安</h4>
                        </div>
                        <div class="bg-white p-5 rounded-lg shadow border border-stone-100">
                            <p class="text-sm text-stone-600">
                                国の政治や後継者選びなど、人智を超えた決定を行う際に神の意志を聞くための道具として使われました。まだ個人の運勢を占うものではありませんでした。</p>
                        </div>
                    </div>
                </div>

                <!-- Timeline Item 2 -->
                <div
                    class="timeline-item relative mb-16 pl-0 md:pl-1/2 w-full flex flex-col md:flex-row items-center md:items-start group">
                    <div class="hidden md:block w-1/2 pr-8 text-right order-1">
                        <div class="bg-white p-5 rounded-lg shadow border border-stone-100">
                            <p class="text-sm text-stone-600">
                                比叡山の僧、良源（元三大師）が観音菩薩から授かったとされる「元三大師百籤（がんざんだいしひゃくせん）」が現在のおみくじの原型です。番号と漢詩による占いが確立されました。</p>
                        </div>
                    </div>
                    <div
                        class="absolute left-1/2 transform -translate-x-1/2 w-6 h-6 rounded-full bg-washi border-4 border-stone-300 z-10 timeline-dot order-2">
                    </div>
                    <div class="w-full md:w-1/2 mt-4 md:mt-0 px-4 md:pl-8 order-3">
                        <h4 class="text-xl font-bold text-torii">鎌倉時代</h4>
                        <p class="text-stone-500 font-serif">元三大師とおみくじの元祖</p>
                        <div class="md:hidden mt-2 bg-white p-5 rounded-lg shadow border border-stone-100">
                            <p class="text-sm text-stone-600">比叡山の僧、良源（元三大師）が観音菩薩から授かったとされる「元三大師百籤」が原型。</p>
                        </div>
                    </div>
                </div>

                <!-- Timeline Item 3 -->
                <div
                    class="timeline-item relative mb-16 pl-0 md:pl-1/2 w-full flex flex-col md:flex-row items-center md:items-start group">
                    <div class="hidden md:block w-1/2 pr-8 text-right order-1">
                        <h4 class="text-xl font-bold text-torii">江戸時代</h4>
                        <p class="text-stone-500 font-serif">庶民への普及と娯楽化</p>
                    </div>
                    <div
                        class="absolute left-1/2 transform -translate-x-1/2 w-6 h-6 rounded-full bg-washi border-4 border-stone-300 z-10 timeline-dot order-2">
                    </div>
                    <div class="w-full md:w-1/2 mt-4 md:mt-0 px-4 md:pl-8 order-3">
                        <div class="md:hidden mb-2">
                            <h4 class="text-xl font-bold text-torii">江戸時代</h4>
                        </div>
                        <div class="bg-white p-5 rounded-lg shadow border border-stone-100">
                            <p class="text-sm text-stone-600">
                                印刷技術の発展と共に、庶民の間でおみくじが大流行しました。「神様からのメッセージ」だけでなく、運試しのレジャーとしての側面も強まりました。</p>
                        </div>
                    </div>
                </div>

                <!-- Timeline Item 4 -->
                <div
                    class="timeline-item relative pl-0 md:pl-1/2 w-full flex flex-col md:flex-row items-center md:items-start group">
                    <div class="hidden md:block w-1/2 pr-8 text-right order-1">
                        <div class="bg-white p-5 rounded-lg shadow border border-stone-100">
                            <p class="text-sm text-stone-600">
                                英語や中国語に対応したおみくじや、「恋みくじ」「猫みくじ」など多様化が進んでいます。一方で、神社本庁などにより伝統の保持も図られています。</p>
                        </div>
                    </div>
                    <div
                        class="absolute left-1/2 transform -translate-x-1/2 w-6 h-6 rounded-full bg-washi border-4 border-stone-300 z-10 timeline-dot order-2">
                    </div>
                    <div class="w-full md:w-1/2 mt-4 md:mt-0 px-4 md:pl-8 order-3">
                        <h4 class="text-xl font-bold text-torii">現代</h4>
                        <p class="text-stone-500 font-serif">多様化とグローバル化</p>
                        <div class="md:hidden mt-2 bg-white p-5 rounded-lg shadow border border-stone-100">
                            <p class="text-sm text-stone-600">多言語対応や多様なバリエーションが登場。伝統と革新が共存しています。</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Method (Interactive Ritual) -->
        <section id="ritual" class="scroll-mt-24">
            <div class="text-center mb-12">
                <span class="text-indigo-800 font-bold tracking-widest text-sm uppercase">Method & Etiquette</span>
                <h2 class="text-3xl md:text-4xl font-bold mt-2">正しいおみくじの作法</h2>
                <p class="mt-4 text-stone-600 max-w-2xl mx-auto">
                    ただ引くだけではもったいない。心を整え、神様と対話するためのステップです。<br>下のボタンで手順を進めてみましょう。
                </p>
            </div>

            <!-- Interactive Stepper -->
            <div class="bg-white rounded-3xl shadow-xl overflow-hidden max-w-4xl mx-auto border border-stone-100">
                <div class="grid grid-cols-1 md:grid-cols-3 h-full min-h-[400px]">
                    <!-- Step Indicators -->
                    <div class="bg-indigo-900 text-white p-8 flex flex-col justify-between">
                        <div>
                            <h3 class="text-2xl font-serif font-bold mb-6">手順</h3>
                            <div class="space-y-4">
                                <div id="indicator-1"
                                    class="flex items-center space-x-3 opacity-100 transition-opacity">
                                    <div
                                        class="w-8 h-8 rounded-full border-2 border-white flex items-center justify-center font-bold bg-white text-indigo-900">
                                        1</div>
                                    <span>参拝・祈願</span>
                                </div>
                                <div id="indicator-2" class="flex items-center space-x-3 opacity-50 transition-opacity">
                                    <div
                                        class="w-8 h-8 rounded-full border-2 border-white flex items-center justify-center font-bold">
                                        2</div>
                                    <span>くじを引く</span>
                                </div>
                                <div id="indicator-3" class="flex items-center space-x-3 opacity-50 transition-opacity">
                                    <div
                                        class="w-8 h-8 rounded-full border-2 border-white flex items-center justify-center font-bold">
                                        3</div>
                                    <span>読み解く</span>
                                </div>
                                <div id="indicator-4" class="flex items-center space-x-3 opacity-50 transition-opacity">
                                    <div
                                        class="w-8 h-8 rounded-full border-2 border-white flex items-center justify-center font-bold">
                                        4</div>
                                    <span>結ぶ・持ち帰る</span>
                                </div>
                            </div>
                        </div>
                        <div class="text-sm text-indigo-200 mt-8">
                            進行状況: <span id="step-count">1</span> / 4
                        </div>
                    </div>

                    <!-- Step Content -->
                    <div
                        class="col-span-2 p-8 md:p-12 flex flex-col justify-center items-center text-center relative bg-washi">
                        <!-- Step 1 -->
                        <div id="step-content-1"
                            class="step-content animate-fade-in absolute inset-0 p-8 flex flex-col justify-center items-center">
                            <div class="text-6xl mb-6">🙏</div>
                            <h4 class="text-2xl font-bold mb-4 text-sumi">まずは参拝から</h4>
                            <p class="text-stone-600 mb-6">
                                おみくじは神様への質問に対する答えです。いきなり引くのではなく、まずは本殿で参拝し、自己紹介と具体的な悩みや問いかけを心の中で唱えましょう。</p>
                            <p class="font-bold text-torii">ポイント：質問は具体的に。「今の私に必要なメッセージをください」でもOK。</p>
                        </div>
                        <!-- Step 2 -->
                        <div id="step-content-2"
                            class="step-content hidden absolute inset-0 p-8 flex flex-col justify-center items-center">
                            <div class="text-6xl mb-6">🗳️</div>
                            <h4 class="text-2xl font-bold mb-4 text-sumi">心を無にして引く</h4>
                            <p class="text-stone-600 mb-6">
                                社務所や授与所へ向かいます。初穂料（代金）を納め、みくじ筒を振る際は、先ほどの質問をもう一度心に念じながら、無心で振りましょう。</p>
                            <p class="font-bold text-torii">ポイント：出てきた棒の番号を巫女さんに伝えるか、自分で引き出しを開けます。</p>
                        </div>
                        <!-- Step 3 -->
                        <div id="step-content-3"
                            class="step-content hidden absolute inset-0 p-8 flex flex-col justify-center items-center">
                            <div class="text-6xl mb-6">📜</div>
                            <h4 class="text-2xl font-bold mb-4 text-sumi">内容を熟読する</h4>
                            <p class="text-stone-600 mb-6">
                                「大吉」や「凶」といった結果よりも、そこに書かれている「和歌」や「教え」が重要です。自分への戒めやアドバイスとして受け止めましょう。</p>
                            <p class="font-bold text-torii">ポイント：厳しい内容こそ、今の自分に必要な改善点かもしれません。</p>
                        </div>
                        <!-- Step 4 -->
                        <div id="step-content-4"
                            class="step-content hidden absolute inset-0 p-8 flex flex-col justify-center items-center">
                            <div class="text-6xl mb-6">🌲</div>
                            <h4 class="text-2xl font-bold mb-4 text-sumi">結ぶか、持ち帰るか</h4>
                            <p class="text-stone-600 mb-6">
                                良い結果は持ち帰りお守りに、悪い結果は境内の指定場所に結んで「神様に預ける（凶を転じて吉となす）」のが一般的ですが、戒めとして持ち帰っても構いません。</p>
                            <p class="font-bold text-torii">ポイント：粗末に扱わず、後日神社にお返ししましょう。</p>
                        </div>

                        <!-- Controls -->
                        <div class="absolute bottom-8 left-0 right-0 flex justify-center space-x-4 px-8">
                            <button onclick="changeStep(-1)" id="prev-btn"
                                class="px-4 py-2 rounded-full border border-stone-300 text-stone-400 disabled:opacity-30"
                                disabled>戻る</button>
                            <button onclick="changeStep(1)" id="next-btn"
                                class="px-6 py-2 rounded-full bg-torii text-white shadow-md hover:bg-red-700 transition-colors">次へ</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: Virtual Experience -->
        <section class="py-16 bg-stone-800 text-washi rounded-3xl text-center relative overflow-hidden">
            <div
                class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/asanoha-400px.png')] opacity-10">
            </div>
            <div class="relative z-10 max-w-2xl mx-auto px-6">
                <span class="text-gold font-bold tracking-widest text-sm uppercase">Simulation</span>
                <h2 class="text-3xl font-serif font-bold mt-2 mb-6 text-white">運試しのシミュレーション</h2>
                <p class="text-stone-300 mb-8">
                    ここまでの学びを活かし、心を静めてボタンを押してみてください。<br>
                    あなたへの「今日の言葉」が表示されます。
                </p>

                <div id="omikuji-result-area"
                    class="bg-washi text-sumi p-8 rounded-lg shadow-2xl max-w-sm mx-auto min-h-[200px] flex flex-col justify-center items-center transition-all transform duration-500">
                    <div id="omikuji-placeholder">
                        <div class="text-6xl mb-4">📿</div>
                        <p class="text-stone-500">心を整えてから<br>下のボタンを押してください</p>
                    </div>
                    <div id="omikuji-content" class="hidden text-center">
                        <h3 id="result-title" class="text-4xl font-serif font-bold text-torii mb-2"></h3>
                        <div class="w-full h-px bg-stone-300 my-4"></div>
                        <p id="result-poem" class="font-serif text-lg mb-4 italic text-stone-600"></p>
                        <p id="result-advice" class="text-sm leading-relaxed"></p>
                    </div>
                </div>

                <button onclick="drawOmikuji()"
                    class="mt-8 bg-gold text-stone-900 px-10 py-4 rounded-full font-bold text-xl shadow-lg hover:bg-yellow-500 hover:scale-105 transition-all">
                    おみくじを引く
                </button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-stone-900 text-stone-400 py-12 border-t border-stone-800">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <h2 class="text-2xl font-serif font-bold text-stone-200 mb-4">おみくじ研究レポート</h2>
            <p class="mb-8 text-sm">作成：占術研究家・歴史家AI</p>
            <div class="flex justify-center space-x-6 text-sm">
                <a href="#" class="hover:text-white transition-colors">トップへ戻る</a>
                <span class="text-stone-700">|</span>
                <span class="cursor-default">© 2024 Omikuji Research</span>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- Navigation Logic ---
        function scrollToSection(id) {
            const element = document.getElementById(id);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
            // Close mobile menu if open
            const menu = document.getElementById('mobile-menu');
            if (!menu.classList.contains('hidden')) {
                menu.classList.add('hidden');
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        function toggleDetail(id) {
            const content = document.getElementById(id);
            const isHidden = content.classList.contains('hidden');

            // Close all others slightly for cleaner UI (Optional, but good UX)
            // document.querySelectorAll('[id^="know-"], [id^="dont-know-"]').forEach(el => el.classList.add('hidden'));

            if (isHidden) {
                content.classList.remove('hidden');
                // Simple animation
                content.style.opacity = '0';
                setTimeout(() => content.style.opacity = '1', 10);
                content.style.transition = 'opacity 0.3s ease';
            } else {
                content.classList.add('hidden');
            }
        }

        // --- Stepper Logic ---
        let currentStep = 1;
        const totalSteps = 4;

        function changeStep(direction) {
            const nextStep = currentStep + direction;
            if (nextStep < 1 || nextStep > totalSteps) return;

            // Hide current
            document.getElementById(`step-content-${currentStep}`).classList.add('hidden');
            document.getElementById(`indicator-${currentStep}`).classList.remove('opacity-100', 'bg-white', 'text-indigo-900');
            document.getElementById(`indicator-${currentStep}`).classList.add('opacity-50');

            // Reset indicator styling for current step (make it outline circle again)
            const currentIndicatorCircle = document.querySelector(`#indicator-${currentStep} div`);
            currentIndicatorCircle.classList.remove('bg-white', 'text-indigo-900');

            // Show next
            currentStep = nextStep;
            document.getElementById(`step-content-${currentStep}`).classList.remove('hidden');
            document.getElementById(`step-content-${currentStep}`).classList.add('animate-fade-in');

            // Update Indicator
            const nextIndicator = document.getElementById(`indicator-${currentStep}`);
            nextIndicator.classList.remove('opacity-50');
            nextIndicator.classList.add('opacity-100');

            const nextIndicatorCircle = document.querySelector(`#indicator-${currentStep} div`);
            nextIndicatorCircle.classList.add('bg-white', 'text-indigo-900');

            // Update Text
            document.getElementById('step-count').innerText = currentStep;

            // Update Buttons
            document.getElementById('prev-btn').disabled = currentStep === 1;

            const nextBtn = document.getElementById('next-btn');
            if (currentStep === totalSteps) {
                nextBtn.innerText = "完了";
                nextBtn.classList.add('bg-bamboo');
                nextBtn.classList.remove('bg-torii');
                nextBtn.onclick = () => scrollToSection('omikuji-result-area'); // Optional guidance
            } else {
                nextBtn.innerText = "次へ";
                nextBtn.classList.add('bg-torii');
                nextBtn.classList.remove('bg-bamboo');
                nextBtn.onclick = () => changeStep(1);
            }
        }

        // --- Virtual Omikuji Logic ---
        const omikujiData = [
            { type: "大吉", poem: "雲晴れて　光り輝く　空の如く", advice: "迷いは消え去りました。自信を持って進みなさい。ただし、慢心は禁物です。" },
            { type: "中吉", poem: "急がば回れ　道は遠くとも", advice: "焦りは禁物です。着実な努力が実を結びます。周囲への感謝を忘れずに。" },
            { type: "小吉", poem: "小さな芽　やがて大樹に　なる予感", advice: "今はまだ結果が出なくとも、基礎を固める時期です。コツコツと続けましょう。" },
            { type: "末吉", poem: "冬越えて　春待つ花も　蕾かな", advice: "今は耐え時です。将来への準備期間と捉え、内面を磨くことに集中しましょう。" },
            { type: "吉", poem: "順風に　帆を上げ進む　船の様", advice: "対人運が良好です。良き協力者が現れるでしょう。素直な心が幸運を呼びます。" },
            { type: "凶", poem: "雨降れば　傘をさせばよし　濡れるまじ", advice: "今は動くべき時ではありません。静観し、計画を見直しましょう。この結果は「気づき」への警告です。" }
        ];

        function drawOmikuji() {
            const container = document.getElementById('omikuji-result-area');
            const placeholder = document.getElementById('omikuji-placeholder');
            const content = document.getElementById('omikuji-content');

            // Animation start
            container.classList.add('scale-95', 'opacity-80');
            setTimeout(() => {
                // Random select
                const result = omikujiData[Math.floor(Math.random() * omikujiData.length)];

                // Update DOM
                document.getElementById('result-title').innerText = result.type;
                document.getElementById('result-title').className = `text-4xl font-serif font-bold mb-2 ${result.type === '凶' ? 'text-gray-500' : 'text-torii'}`;
                document.getElementById('result-poem').innerText = `「${result.poem}」`;
                document.getElementById('result-advice').innerText = result.advice;

                // Toggle visibility
                placeholder.classList.add('hidden');
                content.classList.remove('hidden');

                // Animation end
                container.classList.remove('scale-95', 'opacity-80');
                container.classList.add('scale-100', 'opacity-100');
            }, 300);
        }

        // --- Charts Implementation ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Radar Chart (Comparison)
            const ctxRadar = document.getElementById('radarChart').getContext('2d');
            new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: ['手軽さ', '具体性', '偶然性', '宿命・運命', 'ゲーム性'],
                    datasets: [{
                        label: 'おみくじ',
                        data: [5, 3, 5, 1, 4],
                        fill: true,
                        backgroundColor: 'rgba(200, 62, 40, 0.2)',
                        borderColor: 'rgb(200, 62, 40)',
                        pointBackgroundColor: 'rgb(200, 62, 40)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(200, 62, 40)'
                    }, {
                        label: '西洋占星術',
                        data: [2, 4, 1, 5, 2],
                        fill: true,
                        backgroundColor: 'rgba(43, 79, 105, 0.2)',
                        borderColor: 'rgb(43, 79, 105)',
                        pointBackgroundColor: 'rgb(43, 79, 105)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(43, 79, 105)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    elements: { line: { borderWidth: 3 } },
                    scales: {
                        r: {
                            angleLines: { color: '#E5E7EB' },
                            grid: { color: '#E5E7EB' },
                            pointLabels: {
                                font: { size: 12, family: "'Zen Maru Gothic', sans-serif" },
                                color: '#4B5563'
                            },
                            suggestedMin: 0,
                            suggestedMax: 5
                        }
                    },
                    plugins: {
                        legend: { position: 'top' }
                    }
                }
            });

            // 2. Doughnut Chart (Luck Ratio)
            // Data based on Ganzan Daishi Hyakusen:
            // Great Blessing (16%), Blessing (35%), Small Blessing (6%), Half Blessing (5%), Future Blessing (6%), Curse/Bad (30%)
            const ctxDoughnut = document.getElementById('luckChart').getContext('2d');
            new Chart(ctxDoughnut, {
                type: 'doughnut',
                data: {
                    labels: ['大吉 (16%)', '吉 (35%)', '小吉 (6%)', '半吉・末吉 (13%)', '凶 (30%)'],
                    datasets: [{
                        label: '確率',
                        data: [16, 35, 6, 13, 30],
                        backgroundColor: [
                            '#C83E28', // Dai-kichi (Torii Red)
                            '#F87171', // Kichi (Light Red)
                            '#FCA5A5', // Sho-kichi (Pink)
                            '#FCD34D', // Others (Gold/Yellow)
                            '#4B5563'  // Kyou (Grey)
                        ],
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: { family: "'Zen Maru Gothic', sans-serif" },
                                boxWidth: 12
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return ` ${context.label}`;
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>
</body>

</html>